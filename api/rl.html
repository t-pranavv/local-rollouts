
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Reinforcement Learning &#8212; PhyAGI</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=328381f7" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'api/rl';</script>
    <link rel="canonical" href="https://microsoft.github.io/phyagi/api/rl.html" />
    <link rel="icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Evaluation" href="eval.html" />
    <link rel="prev" title="Trainers" href="trainers.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
    <meta name="docbuild:last-update" content="Sep 16, 2025"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt=""/>
    <script>document.write(`<img src="../_static/logo.png" class="logo__image only-dark" alt=""/>`);</script>
  
  
    <p class="title logo__title">PhyAGI</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Getting started</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../getting_started/installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/build_docker.html">Build a Docker image</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/quick_start.html">Quick start</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Guides</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../guides/logging.html">Logging</a></li>
<li class="toctree-l1"><a class="reference internal" href="../guides/configuration_system.html">Configuration system</a></li>
<li class="toctree-l1"><a class="reference internal" href="../guides/cli.html">Command-Line Interface (CLI)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../guides/data_generation_infrastructure.html">Data generation infrastructure</a></li>
<li class="toctree-l1"><a class="reference internal" href="../guides/llama_cpp_and_gguf.html">Llama.cpp and GGUF</a></li>
<li class="toctree-l1"><a class="reference internal" href="../guides/troubleshooting.html">Troubleshooting</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../tutorials/data_related.html">Data‑related</a></li>


<li class="toctree-l1"><a class="reference internal" href="../tutorials/model_architecture.html">Model architecture</a></li>

<li class="toctree-l1"><a class="reference internal" href="../tutorials/training.html">Training</a></li>

<li class="toctree-l1"><a class="reference internal" href="../tutorials/sft.html">Supervised Fine-Tuning (SFT)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/rlhf.html">Reinforcement Learning from Human Feedback (RLHF)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/evaluation.html">Evaluation</a></li>


</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Advanced tutorials</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../advanced_tutorials/lr_schedulers.html">Learning rate schedulers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../advanced_tutorials/optimizers.html">Optimizers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../advanced_tutorials/parameter_efficient.html">Parameter-Efficient Techniques (PEFT)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../advanced_tutorials/batch_tracking.html">Batch tracking</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Azure</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../azure/sc_alt.html">Log-In with SC-ALT</a></li>
<li class="toctree-l1"><a class="reference internal" href="../azure/pim.html">Elevate permissions with Privileged Identity Management (PIM)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../azure/singularity.html">Submiting jobs with Singularity</a></li>
<li class="toctree-l1"><a class="reference internal" href="../azure/storage_account.html">Azure Storage Account</a></li>
<li class="toctree-l1"><a class="reference internal" href="../azure/virtual_machine.html">Azure Virtual Machine (VM)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../azure/container_registry.html">Azure Container Registry (ACR)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../azure/app_service.html">Azure App Service</a></li>
<li class="toctree-l1"><a class="reference internal" href="../azure/kubernetes_service.html">Azure Kubernetes Service (AKS)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../azure/entra.html">Microsoft Entra</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Contributing</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../contributing/first_time_contributor.html">First time contributor</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributing/documentation.html">Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributing/tests.html">Tests</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">API</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="datasets.html">Datasets</a></li>
<li class="toctree-l1"><a class="reference internal" href="models.html">Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="optimizers.html">Optimizers</a></li>
<li class="toctree-l1"><a class="reference internal" href="trainers.html">Trainers</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Reinforcement Learning</a></li>
<li class="toctree-l1"><a class="reference internal" href="eval.html">Evaluation</a></li>
<li class="toctree-l1"><a class="reference internal" href="utils.html">Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="cli.html">CLI</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/microsoft/phyagi" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/microsoft/phyagi/issues/new?title=Issue%20on%20page%20%2Fapi/rl.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Reinforcement Learning</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Sections </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#models">Models</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#phyagi.rl.models.actor_config.ActorConfig"><code class="docutils literal notranslate"><span class="pre">ActorConfig</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#phyagi.rl.models.actor_config.ActorConfig.to_dict"><code class="docutils literal notranslate"><span class="pre">ActorConfig.to_dict()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#phyagi.rl.models.actor_config.ActorConfig.__init__"><code class="docutils literal notranslate"><span class="pre">ActorConfig.__init__()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#phyagi.rl.models.actor.Actor"><code class="docutils literal notranslate"><span class="pre">Actor</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#phyagi.rl.models.actor.Actor.__init__"><code class="docutils literal notranslate"><span class="pre">Actor.__init__()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#phyagi.rl.models.actor.Actor.configure_model"><code class="docutils literal notranslate"><span class="pre">Actor.configure_model()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#phyagi.rl.models.actor.Actor.configure_optimizers"><code class="docutils literal notranslate"><span class="pre">Actor.configure_optimizers()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#phyagi.rl.models.actor.Actor.configure_parallelisms"><code class="docutils literal notranslate"><span class="pre">Actor.configure_parallelisms()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#phyagi.rl.models.actor.Actor.on_gpu"><code class="docutils literal notranslate"><span class="pre">Actor.on_gpu()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#phyagi.rl.models.actor.Actor.compute_logprobs"><code class="docutils literal notranslate"><span class="pre">Actor.compute_logprobs()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#phyagi.rl.models.actor.Actor.save_checkpoint"><code class="docutils literal notranslate"><span class="pre">Actor.save_checkpoint()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#phyagi.rl.models.actor.Actor.load_checkpoint"><code class="docutils literal notranslate"><span class="pre">Actor.load_checkpoint()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#phyagi.rl.models.actor.Actor.from_checkpoint"><code class="docutils literal notranslate"><span class="pre">Actor.from_checkpoint()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#phyagi.rl.models.reference.Reference"><code class="docutils literal notranslate"><span class="pre">Reference</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#phyagi.rl.models.reference.Reference.__init__"><code class="docutils literal notranslate"><span class="pre">Reference.__init__()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#rewards">Rewards</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#phyagi.rl.rewards.reward.Reward"><code class="docutils literal notranslate"><span class="pre">Reward</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#phyagi.rl.rewards.reward.Reward.__init__"><code class="docutils literal notranslate"><span class="pre">Reward.__init__()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#phyagi.rl.rewards.reward.Reward.score"><code class="docutils literal notranslate"><span class="pre">Reward.score()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#phyagi.rl.rewards.reward_manager.RewardManager"><code class="docutils literal notranslate"><span class="pre">RewardManager</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#phyagi.rl.rewards.reward_manager.RewardManager.__init__"><code class="docutils literal notranslate"><span class="pre">RewardManager.__init__()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#phyagi.rl.rewards.reward_manager.RewardManager.score"><code class="docutils literal notranslate"><span class="pre">RewardManager.score()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#phyagi.rl.rewards.gsm8k.GSM8kReward"><code class="docutils literal notranslate"><span class="pre">GSM8kReward</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#phyagi.rl.rewards.gsm8k.GSM8kReward.__init__"><code class="docutils literal notranslate"><span class="pre">GSM8kReward.__init__()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#phyagi.rl.rewards.gsm8k.GSM8kReward.score"><code class="docutils literal notranslate"><span class="pre">GSM8kReward.score()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#phyagi.rl.rewards.phi4rp.Phi4RPReward"><code class="docutils literal notranslate"><span class="pre">Phi4RPReward</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#phyagi.rl.rewards.phi4rp.Phi4RPReward.__init__"><code class="docutils literal notranslate"><span class="pre">Phi4RPReward.__init__()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#phyagi.rl.rewards.phi4rp.Phi4RPReward.score"><code class="docutils literal notranslate"><span class="pre">Phi4RPReward.score()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#phyagi.rl.rewards.python_code_executor.PythonCodeExecutorReward"><code class="docutils literal notranslate"><span class="pre">PythonCodeExecutorReward</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#phyagi.rl.rewards.python_code_executor.PythonCodeExecutorReward.__init__"><code class="docutils literal notranslate"><span class="pre">PythonCodeExecutorReward.__init__()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#phyagi.rl.rewards.python_code_executor.PythonCodeExecutorReward.score"><code class="docutils literal notranslate"><span class="pre">PythonCodeExecutorReward.score()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#module-phyagi.rl.rewards.registry">Registry</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#phyagi.rl.rewards.registry.get_reward"><code class="docutils literal notranslate"><span class="pre">get_reward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#rollout">Rollout</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#phyagi.rl.rollout.vllm_worker_config.VLLMWorkerConfig"><code class="docutils literal notranslate"><span class="pre">VLLMWorkerConfig</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#phyagi.rl.rollout.vllm_worker_config.VLLMWorkerConfig.to_dict"><code class="docutils literal notranslate"><span class="pre">VLLMWorkerConfig.to_dict()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#phyagi.rl.rollout.vllm_worker_config.VLLMWorkerConfig.__init__"><code class="docutils literal notranslate"><span class="pre">VLLMWorkerConfig.__init__()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#tuners">Tuners</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#phyagi.rl.tuners.ray_worker_config.RayWorkerConfig"><code class="docutils literal notranslate"><span class="pre">RayWorkerConfig</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#phyagi.rl.tuners.ray_worker_config.RayWorkerConfig.to_dict"><code class="docutils literal notranslate"><span class="pre">RayWorkerConfig.to_dict()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#phyagi.rl.tuners.ray_worker_config.RayWorkerConfig.__init__"><code class="docutils literal notranslate"><span class="pre">RayWorkerConfig.__init__()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#phyagi.rl.tuners.ray_worker.RayWorker"><code class="docutils literal notranslate"><span class="pre">RayWorker</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#phyagi.rl.tuners.ray_worker.RayWorker.__init__"><code class="docutils literal notranslate"><span class="pre">RayWorker.__init__()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#phyagi.rl.tuners.ray_worker.RayWorker.configure_models"><code class="docutils literal notranslate"><span class="pre">RayWorker.configure_models()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#phyagi.rl.tuners.ray_worker.RayWorker.save_actor_model"><code class="docutils literal notranslate"><span class="pre">RayWorker.save_actor_model()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#phyagi.rl.tuners.ray_worker.RayWorker.load_actor_model"><code class="docutils literal notranslate"><span class="pre">RayWorker.load_actor_model()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#phyagi.rl.tuners.ray_worker.RayWorker.save_reference_model"><code class="docutils literal notranslate"><span class="pre">RayWorker.save_reference_model()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#phyagi.rl.tuners.ray_worker.RayWorker.load_reference_model"><code class="docutils literal notranslate"><span class="pre">RayWorker.load_reference_model()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#phyagi.rl.tuners.ray_worker.RayWorker.generate_completions"><code class="docutils literal notranslate"><span class="pre">RayWorker.generate_completions()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#phyagi.rl.tuners.ray_worker.RayWorker.compute_loss"><code class="docutils literal notranslate"><span class="pre">RayWorker.compute_loss()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#phyagi.rl.tuners.ray_worker.RayWorker.update_actor_policy"><code class="docutils literal notranslate"><span class="pre">RayWorker.update_actor_policy()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#hugging-face">Hugging Face</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#grpo">GRPO</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#phyagi.rl.tuners.grpo.grpo_config.RayGRPOConfig"><code class="docutils literal notranslate"><span class="pre">RayGRPOConfig</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#phyagi.rl.tuners.grpo.grpo_config.RayGRPOConfig.__init__"><code class="docutils literal notranslate"><span class="pre">RayGRPOConfig.__init__()</span></code></a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#phyagi.rl.tuners.grpo.grpo_worker.RayGRPOWorker"><code class="docutils literal notranslate"><span class="pre">RayGRPOWorker</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#phyagi.rl.tuners.grpo.grpo_worker.RayGRPOWorker.__init__"><code class="docutils literal notranslate"><span class="pre">RayGRPOWorker.__init__()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#phyagi.rl.tuners.grpo.grpo_worker.RayGRPOWorker.compute_loss"><code class="docutils literal notranslate"><span class="pre">RayGRPOWorker.compute_loss()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#phyagi.rl.tuners.grpo.grpo_worker.RayGRPOWorker.update_actor_policy"><code class="docutils literal notranslate"><span class="pre">RayGRPOWorker.update_actor_policy()</span></code></a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#phyagi.rl.tuners.grpo.grpo_tuner.RayGRPOTuner"><code class="docutils literal notranslate"><span class="pre">RayGRPOTuner</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#phyagi.rl.tuners.grpo.grpo_tuner.RayGRPOTuner.__init__"><code class="docutils literal notranslate"><span class="pre">RayGRPOTuner.__init__()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#phyagi.rl.tuners.grpo.grpo_tuner.RayGRPOTuner.get_train_dataloader"><code class="docutils literal notranslate"><span class="pre">RayGRPOTuner.get_train_dataloader()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#phyagi.rl.tuners.grpo.grpo_tuner.RayGRPOTuner.generate_completions"><code class="docutils literal notranslate"><span class="pre">RayGRPOTuner.generate_completions()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#phyagi.rl.tuners.grpo.grpo_tuner.RayGRPOTuner.save_checkpoint"><code class="docutils literal notranslate"><span class="pre">RayGRPOTuner.save_checkpoint()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#phyagi.rl.tuners.grpo.grpo_tuner.RayGRPOTuner.load_checkpoint"><code class="docutils literal notranslate"><span class="pre">RayGRPOTuner.load_checkpoint()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#phyagi.rl.tuners.grpo.grpo_tuner.RayGRPOTuner.evaluate"><code class="docutils literal notranslate"><span class="pre">RayGRPOTuner.evaluate()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#isft">ISFT</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#phyagi.rl.tuners.isft.isft_config.RayISFTConfig"><code class="docutils literal notranslate"><span class="pre">RayISFTConfig</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#phyagi.rl.tuners.isft.isft_config.RayISFTConfig.__init__"><code class="docutils literal notranslate"><span class="pre">RayISFTConfig.__init__()</span></code></a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#phyagi.rl.tuners.isft.isft_worker.RayISFTWorker"><code class="docutils literal notranslate"><span class="pre">RayISFTWorker</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#phyagi.rl.tuners.isft.isft_worker.RayISFTWorker.__init__"><code class="docutils literal notranslate"><span class="pre">RayISFTWorker.__init__()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#phyagi.rl.tuners.isft.isft_worker.RayISFTWorker.configure_models"><code class="docutils literal notranslate"><span class="pre">RayISFTWorker.configure_models()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#phyagi.rl.tuners.isft.isft_worker.RayISFTWorker.compute_loss"><code class="docutils literal notranslate"><span class="pre">RayISFTWorker.compute_loss()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#phyagi.rl.tuners.isft.isft_worker.RayISFTWorker.update_actor_policy"><code class="docutils literal notranslate"><span class="pre">RayISFTWorker.update_actor_policy()</span></code></a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#phyagi.rl.tuners.isft.isft_tuner.RayISFTTuner"><code class="docutils literal notranslate"><span class="pre">RayISFTTuner</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#phyagi.rl.tuners.isft.isft_tuner.RayISFTTuner.__init__"><code class="docutils literal notranslate"><span class="pre">RayISFTTuner.__init__()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#phyagi.rl.tuners.isft.isft_tuner.RayISFTTuner.get_train_dataloader"><code class="docutils literal notranslate"><span class="pre">RayISFTTuner.get_train_dataloader()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#phyagi.rl.tuners.isft.isft_tuner.RayISFTTuner.generate_completions"><code class="docutils literal notranslate"><span class="pre">RayISFTTuner.generate_completions()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#phyagi.rl.tuners.isft.isft_tuner.RayISFTTuner.save_checkpoint"><code class="docutils literal notranslate"><span class="pre">RayISFTTuner.save_checkpoint()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#phyagi.rl.tuners.isft.isft_tuner.RayISFTTuner.load_checkpoint"><code class="docutils literal notranslate"><span class="pre">RayISFTTuner.load_checkpoint()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#phyagi.rl.tuners.isft.isft_tuner.RayISFTTuner.evaluate"><code class="docutils literal notranslate"><span class="pre">RayISFTTuner.evaluate()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Registry</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#phyagi.rl.tuners.registry.get_tuning_args"><code class="docutils literal notranslate"><span class="pre">get_tuning_args()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#phyagi.rl.tuners.registry.get_tuner"><code class="docutils literal notranslate"><span class="pre">get_tuner()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="reinforcement-learning">
<h1>Reinforcement Learning<a class="headerlink" href="#reinforcement-learning" title="Link to this heading">#</a></h1>
<section id="models">
<h2>Models<a class="headerlink" href="#models" title="Link to this heading">#</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="phyagi.rl.models.actor_config.ActorConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">phyagi.rl.models.actor_config.</span></span><span class="sig-name descname"><span class="pre">ActorConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model:</span> <span class="pre">~typing.Dict[str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">~typing.Any]</span> <span class="pre">=</span> <span class="pre">&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_meta_tensor:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer:</span> <span class="pre">~typing.Dict[str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">~typing.Any]</span> <span class="pre">=</span> <span class="pre">&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scheduler:</span> <span class="pre">~typing.Dict[str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">int</span> <span class="pre">|</span> <span class="pre">float</span> <span class="pre">|</span> <span class="pre">bool</span> <span class="pre">|</span> <span class="pre">None]</span> <span class="pre">=</span> <span class="pre">&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gradient_clipping:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">manual_offload:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fsdp_offload:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">activation_checkpointing:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype:</span> <span class="pre">str</span> <span class="pre">=</span> <span class="pre">'bfloat16'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adam_8bit:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">context_parallel_size:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tensor_parallel_size:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tp_loss_parallel:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/phyagi/rl/models/actor_config.html#ActorConfig"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#phyagi.rl.models.actor_config.ActorConfig" title="Link to this definition">#</a></dt>
<dd><p>Actor model (with FSDP support) configuration.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> – Model configuration.</p></li>
<li><p><strong>use_meta_tensor</strong> – Whether to initialize the model using meta-tensors.</p></li>
<li><p><strong>optimizer</strong> – Optimizer configuration.</p></li>
<li><p><strong>scheduler</strong> – Learning rate scheduler configuration.</p></li>
<li><p><strong>gradient_clipping</strong> – Gradient clipping value.</p></li>
<li><p><strong>manual_offload</strong> – Whether to manually offload the model to CPU.</p></li>
<li><p><strong>fsdp_offload</strong> – Whether to use FSDP-based CPU offload.</p></li>
<li><p><strong>activation_checkpointing</strong> – Whether to use activation checkpointing.</p></li>
<li><p><strong>dtype</strong> – Precision of the model.</p></li>
<li><p><strong>adam_8bit</strong> – Whether to use 8-bit AdamW optimizer.</p></li>
<li><p><strong>context_parallel_size</strong> – Size of the context parallel group.</p></li>
<li><p><strong>tensor_parallel_size</strong> – Size of the tensor parallel group.</p></li>
<li><p><strong>tp_loss_parallel</strong> – Whether to use loss parallelism in tensor parallelism.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="phyagi.rl.models.actor_config.ActorConfig.to_dict">
<span class="sig-name descname"><span class="pre">to_dict</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/phyagi/rl/models/actor_config.html#ActorConfig.to_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#phyagi.rl.models.actor_config.ActorConfig.to_dict" title="Link to this definition">#</a></dt>
<dd><p>Convert attributes into a dictionary.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Attributes encoded as a dictionary.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="phyagi.rl.models.actor_config.ActorConfig.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model:</span> <span class="pre">~typing.Dict[str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">~typing.Any]</span> <span class="pre">=</span> <span class="pre">&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_meta_tensor:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer:</span> <span class="pre">~typing.Dict[str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">~typing.Any]</span> <span class="pre">=</span> <span class="pre">&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scheduler:</span> <span class="pre">~typing.Dict[str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">int</span> <span class="pre">|</span> <span class="pre">float</span> <span class="pre">|</span> <span class="pre">bool</span> <span class="pre">|</span> <span class="pre">None]</span> <span class="pre">=</span> <span class="pre">&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gradient_clipping:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">manual_offload:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fsdp_offload:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">activation_checkpointing:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype:</span> <span class="pre">str</span> <span class="pre">=</span> <span class="pre">'bfloat16'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adam_8bit:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">context_parallel_size:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tensor_parallel_size:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tp_loss_parallel:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#phyagi.rl.models.actor_config.ActorConfig.__init__" title="Link to this definition">#</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="phyagi.rl.models.actor.Actor">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">phyagi.rl.models.actor.</span></span><span class="sig-name descname"><span class="pre">Actor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#phyagi.rl.models.actor_config.ActorConfig" title="phyagi.rl.models.actor_config.ActorConfig"><span class="pre">ActorConfig</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">device_mesh</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DeviceMesh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">checkpoint_manager</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="utils.html#phyagi.utils.checkpoint.CheckpointManager" title="phyagi.utils.checkpoint.CheckpointManager"><span class="pre">CheckpointManager</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logger</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Logger</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/phyagi/rl/models/actor.html#Actor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#phyagi.rl.models.actor.Actor" title="Link to this definition">#</a></dt>
<dd><p>Ray actor model (with FSDP support).</p>
<dl class="py method">
<dt class="sig sig-object py" id="phyagi.rl.models.actor.Actor.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#phyagi.rl.models.actor_config.ActorConfig" title="phyagi.rl.models.actor_config.ActorConfig"><span class="pre">ActorConfig</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">device_mesh</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DeviceMesh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">checkpoint_manager</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="utils.html#phyagi.utils.checkpoint.CheckpointManager" title="phyagi.utils.checkpoint.CheckpointManager"><span class="pre">CheckpointManager</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logger</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Logger</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/phyagi/rl/models/actor.html#Actor.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#phyagi.rl.models.actor.Actor.__init__" title="Link to this definition">#</a></dt>
<dd><p>Initialize the actor model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>config</strong> – Actor model configuration.</p></li>
<li><p><strong>device_mesh</strong> – Device mesh.</p></li>
<li><p><strong>checkpoint_manager</strong> – Checkpoint manager for saving/loading checkpoints.</p></li>
<li><p><strong>logger</strong> – Logger for the actor model.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="phyagi.rl.models.actor.Actor.configure_model">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">configure_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pretrained_model_name_or_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">precision</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="models.html#phyagi.models.mixformer_sequential.modeling_mixformer_sequential.MixFormerSequentialForCausalLM" title="phyagi.models.mixformer_sequential.modeling_mixformer_sequential.MixFormerSequentialForCausalLM"><span class="pre">MixFormerSequentialForCausalLM</span></a></span></span><a class="reference internal" href="../_modules/phyagi/rl/models/actor.html#Actor.configure_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#phyagi.rl.models.actor.Actor.configure_model" title="Link to this definition">#</a></dt>
<dd><p>Configure the model for the actor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pretrained_model_name_or_path</strong> – Pretrained model name or path.</p></li>
<li><p><strong>precision</strong> – Precision to use for the model.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Configured model.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="phyagi.rl.models.actor.Actor.configure_optimizers">
<span class="sig-name descname"><span class="pre">configure_optimizers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">total_training_steps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/phyagi/rl/models/actor.html#Actor.configure_optimizers"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#phyagi.rl.models.actor.Actor.configure_optimizers" title="Link to this definition">#</a></dt>
<dd><p>Configure optimizers and learning rate scheduler for the actor model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>total_training_steps</strong> – Total number of training steps.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="phyagi.rl.models.actor.Actor.configure_parallelisms">
<span class="sig-name descname"><span class="pre">configure_parallelisms</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/phyagi/rl/models/actor.html#Actor.configure_parallelisms"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#phyagi.rl.models.actor.Actor.configure_parallelisms" title="Link to this definition">#</a></dt>
<dd><p>Configure parallelisms for the actor model.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="phyagi.rl.models.actor.Actor.on_gpu">
<span class="sig-name descname"><span class="pre">on_gpu</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_only</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer_only</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">empty_cache</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Generator</span><span class="p"><span class="pre">[</span></span><span class="pre">None</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">None</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">None</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/phyagi/rl/models/actor.html#Actor.on_gpu"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#phyagi.rl.models.actor.Actor.on_gpu" title="Link to this definition">#</a></dt>
<dd><p>Context manager to move the model and optimizer to GPU.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model_only</strong> – Whether to move only the model to GPU.</p></li>
<li><p><strong>optimizer_only</strong> – Whether to move only the optimizer to GPU.</p></li>
<li><p><strong>empty_cache</strong> – Whether to empty the CUDA cache after offloading.</p></li>
</ul>
</dd>
<dt class="field-even">Yields<span class="colon">:</span></dt>
<dd class="field-even"><p>Context manager that moves the model and optimizer to GPU.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="phyagi.rl.models.actor.Actor.compute_logprobs">
<span class="sig-name descname"><span class="pre">compute_logprobs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_ids</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">assistant_masks</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">BoolTensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">position_ids</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">LongTensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cu_seqlens</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">IntTensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temperature</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compute_entropy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">FloatTensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/phyagi/rl/models/actor.html#Actor.compute_logprobs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#phyagi.rl.models.actor.Actor.compute_logprobs" title="Link to this definition">#</a></dt>
<dd><p>Compute log probabilities for the given input identifiers and assistant masks.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_ids</strong> – Input identifiers tensor.</p></li>
<li><p><strong>assistant_masks</strong> – Assistant masks tensor.</p></li>
<li><p><strong>position_ids</strong> – Position identifiers tensor</p></li>
<li><p><strong>cu_seqlens</strong> – Cumulative sequence lengths tensor.</p></li>
<li><p><strong>temperature</strong> – Temperature for scaling logits.</p></li>
<li><p><strong>compute_entropy</strong> – Whether to compute entropy.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dictionary with log probablities and entropy (optional).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="phyagi.rl.models.actor.Actor.save_checkpoint">
<span class="sig-name descname"><span class="pre">save_checkpoint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">checkpoint_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrite</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_optimizer_states</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_lr_scheduler_states</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/phyagi/rl/models/actor.html#Actor.save_checkpoint"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#phyagi.rl.models.actor.Actor.save_checkpoint" title="Link to this definition">#</a></dt>
<dd><p>Save a checkpoint.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>checkpoint_path</strong> – Path to save the checkpoint.</p></li>
<li><p><strong>overwrite</strong> – Whether to overwrite the existing checkpoint.</p></li>
<li><p><strong>save_optimizer_states</strong> – Whether to save the optimizer states.</p></li>
<li><p><strong>save_lr_scheduler_states</strong> – Whether to save the learning rate scheduler states.</p></li>
<li><p><strong>save_config</strong> – Whether to save the model configuration.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="phyagi.rl.models.actor.Actor.load_checkpoint">
<span class="sig-name descname"><span class="pre">load_checkpoint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">load_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">load_optimizer_states</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">load_scheduler_states</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/phyagi/rl/models/actor.html#Actor.load_checkpoint"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#phyagi.rl.models.actor.Actor.load_checkpoint" title="Link to this definition">#</a></dt>
<dd><p>Load a checkpoint.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>load_dir</strong> – Directory to load the checkpoint from.</p></li>
<li><p><strong>load_optimizer_states</strong> – Whether to load the optimizer states.</p></li>
<li><p><strong>load_scheduler_states</strong> – Whether to load the learning rate scheduler states.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="phyagi.rl.models.actor.Actor.from_checkpoint">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_checkpoint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">checkpoint_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device_mesh</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DeviceMesh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#phyagi.rl.models.actor_config.ActorConfig" title="phyagi.rl.models.actor_config.ActorConfig"><span class="pre">ActorConfig</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">checkpoint_manager</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="utils.html#phyagi.utils.checkpoint.CheckpointManager" title="phyagi.utils.checkpoint.CheckpointManager"><span class="pre">CheckpointManager</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logger</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Logger</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#phyagi.rl.models.actor.Actor" title="phyagi.rl.models.actor.Actor"><span class="pre">Actor</span></a></span></span><a class="reference internal" href="../_modules/phyagi/rl/models/actor.html#Actor.from_checkpoint"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#phyagi.rl.models.actor.Actor.from_checkpoint" title="Link to this definition">#</a></dt>
<dd><p>Create a Ray actor from a checkpoint.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>checkpoint_dir</strong> – Directory to load the checkpoint from.</p></li>
<li><p><strong>config</strong> – Actor model configuration.</p></li>
<li><p><strong>device_mesh</strong> – Device mesh.</p></li>
<li><p><strong>checkpoint_manager</strong> – Checkpoint manager for saving/loading checkpoints.</p></li>
<li><p><strong>logger</strong> – Logger for the actor model.</p></li>
<li><p><strong>load_optimizer_states</strong> – Whether to load the optimizer states.</p></li>
<li><p><strong>load_scheduler_states</strong> – Whether to load the learning rate scheduler states.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Ray actor instance.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="phyagi.rl.models.reference.Reference">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">phyagi.rl.models.reference.</span></span><span class="sig-name descname"><span class="pre">Reference</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#phyagi.rl.models.actor_config.ActorConfig" title="phyagi.rl.models.actor_config.ActorConfig"><span class="pre">ActorConfig</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">device_mesh</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DeviceMesh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">checkpoint_manager</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="utils.html#phyagi.utils.checkpoint.CheckpointManager" title="phyagi.utils.checkpoint.CheckpointManager"><span class="pre">CheckpointManager</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">logger</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Logger</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/phyagi/rl/models/reference.html#Reference"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#phyagi.rl.models.reference.Reference" title="Link to this definition">#</a></dt>
<dd><p>Ray reference model (with FSDP support).</p>
<dl class="py method">
<dt class="sig sig-object py" id="phyagi.rl.models.reference.Reference.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#phyagi.rl.models.actor_config.ActorConfig" title="phyagi.rl.models.actor_config.ActorConfig"><span class="pre">ActorConfig</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">device_mesh</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DeviceMesh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">checkpoint_manager</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="utils.html#phyagi.utils.checkpoint.CheckpointManager" title="phyagi.utils.checkpoint.CheckpointManager"><span class="pre">CheckpointManager</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">logger</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Logger</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/phyagi/rl/models/reference.html#Reference.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#phyagi.rl.models.reference.Reference.__init__" title="Link to this definition">#</a></dt>
<dd><p>Initialize the reference model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>config</strong> – Reference model configuration.</p></li>
<li><p><strong>device_mesh</strong> – Device mesh.</p></li>
<li><p><strong>checkpoint_manager</strong> – Checkpoint manager for saving/loading checkpoints.</p></li>
<li><p><strong>logger</strong> – Logger for the reference model.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="rewards">
<h2>Rewards<a class="headerlink" href="#rewards" title="Link to this heading">#</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="phyagi.rl.rewards.reward.Reward">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">phyagi.rl.rewards.reward.</span></span><span class="sig-name descname"><span class="pre">Reward</span></span><a class="reference internal" href="../_modules/phyagi/rl/rewards/reward.html#Reward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#phyagi.rl.rewards.reward.Reward" title="Link to this definition">#</a></dt>
<dd><p>Abstract class for rewards.</p>
<p>This class serves as a base for implementing rewards that can be used to
evaluate the performance of a solution against a ground truth. It enforces
implementation of the <a class="reference internal" href="#phyagi.rl.rewards.reward.Reward.score" title="phyagi.rl.rewards.reward.Reward.score"><code class="xref py py-meth docutils literal notranslate"><span class="pre">score()</span></code></a> method, which takes a solution and
ground truth as input and returns a score.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span><span class="w"> </span><span class="nc">MyReward</span><span class="p">(</span><span class="n">Reward</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="k">pass</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">def</span><span class="w"> </span><span class="nf">score</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">solution</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">ground_truth</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="k">return</span> <span class="mf">1.0</span> <span class="k">if</span> <span class="n">solution</span> <span class="o">==</span> <span class="n">ground_truth</span> <span class="k">else</span> <span class="mf">0.0</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="phyagi.rl.rewards.reward.Reward.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/phyagi/rl/rewards/reward.html#Reward.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#phyagi.rl.rewards.reward.Reward.__init__" title="Link to this definition">#</a></dt>
<dd><p>Initialize the reward.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="phyagi.rl.rewards.reward.Reward.score">
<span class="sig-name descname"><span class="pre">score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solution</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ground_truth</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="../_modules/phyagi/rl/rewards/reward.html#Reward.score"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#phyagi.rl.rewards.reward.Reward.score" title="Link to this definition">#</a></dt>
<dd><p>Calculate the score of a solution against the ground truth.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solution</strong> – Solution to be evaluated.</p></li>
<li><p><strong>ground_truth</strong> – Ground truth to compare against.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Score of the solution against the ground truth.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="phyagi.rl.rewards.reward_manager.RewardManager">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">phyagi.rl.rewards.reward_manager.</span></span><span class="sig-name descname"><span class="pre">RewardManager</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rewards</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#phyagi.rl.rewards.reward.Reward" title="phyagi.rl.rewards.reward.Reward"><span class="pre">Reward</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_workers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/phyagi/rl/rewards/reward_manager.html#RewardManager"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#phyagi.rl.rewards.reward_manager.RewardManager" title="Link to this definition">#</a></dt>
<dd><p>Manages multiple reward functions and distributes the workload across multiple workers.</p>
<dl class="py method">
<dt class="sig sig-object py" id="phyagi.rl.rewards.reward_manager.RewardManager.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rewards</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#phyagi.rl.rewards.reward.Reward" title="phyagi.rl.rewards.reward.Reward"><span class="pre">Reward</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_workers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/phyagi/rl/rewards/reward_manager.html#RewardManager.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#phyagi.rl.rewards.reward_manager.RewardManager.__init__" title="Link to this definition">#</a></dt>
<dd><p>Initialize the reward manager.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rewards</strong> – Dictionary of reward names and their corresponding reward functions.</p></li>
<li><p><strong>num_workers</strong> – Number of workers to use for parallel processing.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="phyagi.rl.rewards.reward_manager.RewardManager.score">
<span class="sig-name descname"><span class="pre">score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">generations</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">vllm.CompletionOutput</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ground_truths</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reward_names</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reward_weights</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/phyagi/rl/rewards/reward_manager.html#RewardManager.score"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#phyagi.rl.rewards.reward_manager.RewardManager.score" title="Link to this definition">#</a></dt>
<dd><p>Score the generated completions against the ground truth using the specified rewards.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>generations</strong> – Generated completions.</p></li>
<li><p><strong>ground_truths</strong> – Ground truth strings.</p></li>
<li><p><strong>reward_names</strong> – Reward names to use for scoring.</p></li>
<li><p><strong>reward_weights</strong> – Weights for each reward.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dictionaries containing the scores for each reward.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="phyagi.rl.rewards.gsm8k.GSM8kReward">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">phyagi.rl.rewards.gsm8k.</span></span><span class="sig-name descname"><span class="pre">GSM8kReward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'strict'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">format_score</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">correct_score</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/phyagi/rl/rewards/gsm8k.html#GSM8kReward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#phyagi.rl.rewards.gsm8k.GSM8kReward" title="Link to this definition">#</a></dt>
<dd><p>Reward function for GSM8k-style arithmetic problems.</p>
<p>This reward function extracts the answer from the model-generated solution and compares
it to the ground truth answer. It supports two methods of extraction:</p>
<blockquote>
<div><ul class="simple">
<li><p>“strict”: Requires an exact match of the answer format.</p></li>
<li><p>“flexible”: Allows for some flexibility in the answer format.</p></li>
</ul>
</div></blockquote>
<p>The reward is computed based on whether the extracted answer matches the ground truth.
If the answer is correct, it returns a score of <cite>correct_score</cite>, otherwise it returns
<cite>format_score</cite>.</p>
<dl class="py method">
<dt class="sig sig-object py" id="phyagi.rl.rewards.gsm8k.GSM8kReward.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'strict'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">format_score</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">correct_score</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/phyagi/rl/rewards/gsm8k.html#GSM8kReward.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#phyagi.rl.rewards.gsm8k.GSM8kReward.__init__" title="Link to this definition">#</a></dt>
<dd><p>Initialize the reward.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>method</strong> – Method to use for extracting the answer from the solution.</p></li>
<li><p><strong>format_score</strong> – Score to return if the answer is not correct.</p></li>
<li><p><strong>correct_score</strong> – Score to return if the answer is correct.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="phyagi.rl.rewards.gsm8k.GSM8kReward.score">
<span class="sig-name descname"><span class="pre">score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solution</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ground_truth</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="../_modules/phyagi/rl/rewards/gsm8k.html#GSM8kReward.score"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#phyagi.rl.rewards.gsm8k.GSM8kReward.score" title="Link to this definition">#</a></dt>
<dd><p>Calculate the score of a solution against the ground truth.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solution</strong> – Solution to be evaluated.</p></li>
<li><p><strong>ground_truth</strong> – Ground truth to compare against.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Score of the solution against the ground truth.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="phyagi.rl.rewards.phi4rp.Phi4RPReward">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">phyagi.rl.rewards.phi4rp.</span></span><span class="sig-name descname"><span class="pre">Phi4RPReward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tokenizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">PreTrainedTokenizer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_response_length</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">12976</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_length_control</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unit_length</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/phyagi/rl/rewards/phi4rp.html#Phi4RPReward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#phyagi.rl.rewards.phi4rp.Phi4RPReward" title="Link to this definition">#</a></dt>
<dd><p>Phi-4-reasoning-plus reward.</p>
<dl class="py method">
<dt class="sig sig-object py" id="phyagi.rl.rewards.phi4rp.Phi4RPReward.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tokenizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">PreTrainedTokenizer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_response_length</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">12976</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_length_control</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unit_length</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/phyagi/rl/rewards/phi4rp.html#Phi4RPReward.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#phyagi.rl.rewards.phi4rp.Phi4RPReward.__init__" title="Link to this definition">#</a></dt>
<dd><p>Initialize the reward.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tokenizer</strong> – Tokenizer to use for encoding the responses.</p></li>
<li><p><strong>max_response_length</strong> – Maximum length of the response.</p></li>
<li><p><strong>max_length_control</strong> – Maximum length for controlling the reward scaling.</p></li>
<li><p><strong>unit_length</strong> – Unit length for scaling the reward.
If not provided, it will be set to a value based on <code class="docutils literal notranslate"><span class="pre">max_response_length</span></code>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="phyagi.rl.rewards.phi4rp.Phi4RPReward.score">
<span class="sig-name descname"><span class="pre">score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solution</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ground_truth</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="../_modules/phyagi/rl/rewards/phi4rp.html#Phi4RPReward.score"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#phyagi.rl.rewards.phi4rp.Phi4RPReward.score" title="Link to this definition">#</a></dt>
<dd><p>Calculate the score of a solution against the ground truth.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solution</strong> – Solution to be evaluated.</p></li>
<li><p><strong>ground_truth</strong> – Ground truth to compare against.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Score of the solution against the ground truth.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="phyagi.rl.rewards.python_code_executor.PythonCodeExecutorReward">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">phyagi.rl.rewards.python_code_executor.</span></span><span class="sig-name descname"><span class="pre">PythonCodeExecutorReward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">service_url</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">incorrect_reward</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">auth_token</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">managed_identity</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extract_markdown</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_runtime</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">10.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_request_timeout</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">30.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/phyagi/rl/rewards/python_code_executor.html#PythonCodeExecutorReward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#phyagi.rl.rewards.python_code_executor.PythonCodeExecutorReward" title="Link to this definition">#</a></dt>
<dd><p>Python code executor reward.</p>
<dl class="py method">
<dt class="sig sig-object py" id="phyagi.rl.rewards.python_code_executor.PythonCodeExecutorReward.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">service_url</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">incorrect_reward</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">auth_token</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">managed_identity</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extract_markdown</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_runtime</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">10.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_request_timeout</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">30.0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/phyagi/rl/rewards/python_code_executor.html#PythonCodeExecutorReward.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#phyagi.rl.rewards.python_code_executor.PythonCodeExecutorReward.__init__" title="Link to this definition">#</a></dt>
<dd><p>Initialize the reward.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>service_url</strong> – URL of the remote Python executor service.</p></li>
<li><p><strong>incorrect_reward</strong> – Reward for incorrect solutions.</p></li>
<li><p><strong>auth_token</strong> – Authentication token for the remote service.</p></li>
<li><p><strong>managed_identity</strong> – Managed identity for Azure authentication.</p></li>
<li><p><strong>extract_markdown</strong> – Whether to extract Python code from markdown.</p></li>
<li><p><strong>max_runtime</strong> – Maximum runtime for the code execution.</p></li>
<li><p><strong>max_request_timeout</strong> – Maximum timeout for the request.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="phyagi.rl.rewards.python_code_executor.PythonCodeExecutorReward.score">
<span class="sig-name descname"><span class="pre">score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solution</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ground_truth</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="../_modules/phyagi/rl/rewards/python_code_executor.html#PythonCodeExecutorReward.score"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#phyagi.rl.rewards.python_code_executor.PythonCodeExecutorReward.score" title="Link to this definition">#</a></dt>
<dd><p>Calculate the score of a solution against the ground truth.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solution</strong> – Solution to be evaluated.</p></li>
<li><p><strong>ground_truth</strong> – Ground truth to compare against.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Score of the solution against the ground truth.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<section id="module-phyagi.rl.rewards.registry">
<span id="registry"></span><h3>Registry<a class="headerlink" href="#module-phyagi.rl.rewards.registry" title="Link to this heading">#</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="phyagi.rl.rewards.registry.get_reward">
<span class="sig-prename descclassname"><span class="pre">phyagi.rl.rewards.registry.</span></span><span class="sig-name descname"><span class="pre">get_reward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">reward_configs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#phyagi.rl.rewards.reward.Reward" title="phyagi.rl.rewards.reward.Reward"><span class="pre">Reward</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/phyagi/rl/rewards/registry.html#get_reward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#phyagi.rl.rewards.registry.get_reward" title="Link to this definition">#</a></dt>
<dd><p>Get rewards.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>reward_configs</strong> – Reward configuration.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dictionary of rewards.</p>
</dd>
</dl>
</dd></dl>

</section>
</section>
<section id="rollout">
<h2>Rollout<a class="headerlink" href="#rollout" title="Link to this heading">#</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="phyagi.rl.rollout.vllm_worker_config.VLLMWorkerConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">phyagi.rl.rollout.vllm_worker_config.</span></span><span class="sig-name descname"><span class="pre">VLLMWorkerConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prompt_length:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">1024</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">response_length:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">8192</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tensor_parallel_size:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offload:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype:</span> <span class="pre">str</span> <span class="pre">=</span> <span class="pre">'auto'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gpu_memory_utilization:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">0.9</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">swap_space:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">64.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enforce_eager:</span> <span class="pre">bool</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hf_overrides:</span> <span class="pre">~typing.Dict[str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">~typing.Any]</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enable_chunked_prefill:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enable_prefix_caching:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">preemption_mode:</span> <span class="pre">str</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_num_batched_tokens:</span> <span class="pre">int</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_num_seqs:</span> <span class="pre">int</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kv_cache_dtype:</span> <span class="pre">str</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">'auto'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampling_params:</span> <span class="pre">~typing.Dict[str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">~typing.Any]</span> <span class="pre">=</span> <span class="pre">&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval_sampling_params:</span> <span class="pre">~typing.Dict[str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">~typing.Any]</span> <span class="pre">=</span> <span class="pre">&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">disable_log_stats:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extra_kwargs:</span> <span class="pre">~typing.Dict[str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">~typing.Any]</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/phyagi/rl/rollout/vllm_worker_config.html#VLLMWorkerConfig"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#phyagi.rl.rollout.vllm_worker_config.VLLMWorkerConfig" title="Link to this definition">#</a></dt>
<dd><p>vLLM worker configuration.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>prompt_length</strong> – Maximum prompt length accepted.</p></li>
<li><p><strong>response_length</strong> – Maximum length of the generated response.</p></li>
<li><p><strong>tensor_parallel_size</strong> – Number of GPUs to use for distributed execution with tensor parallelism.</p></li>
<li><p><strong>offload</strong> – Whether to offload the model to CPU when not in use.</p></li>
<li><p><strong>dtype</strong> – Data type for the model weights and activations.
If <code class="docutils literal notranslate"><span class="pre">auto</span></code>, we use the <code class="docutils literal notranslate"><span class="pre">torch_dtype</span></code> attribute specified in the model configuration file.
If the <code class="docutils literal notranslate"><span class="pre">torch_dtype</span></code> in the configuration is <code class="docutils literal notranslate"><span class="pre">float32</span></code>, we will use <code class="docutils literal notranslate"><span class="pre">float16</span></code> instead.</p></li>
<li><p><strong>gpu_memory_utilization</strong> – Ratio of GPU memory to reserve for the model weights, activations, and KV-cache.</p></li>
<li><p><strong>swap_space</strong> – Size (GiB) of CPU memory per GPU to use as swap space.</p></li>
<li><p><strong>enforce_eager</strong> – Whether to enforce eager execution.</p></li>
<li><p><strong>hf_overrides</strong> – Arguments forwarded to the Hugging Face configuration.</p></li>
<li><p><strong>enable_chunked_prefill</strong> – Whether prefill requests can be chunked based on the <code class="docutils literal notranslate"><span class="pre">max_num_batched_tokens</span></code>.</p></li>
<li><p><strong>enable_prefix_caching</strong> – Whether to enable prefix caching.</p></li>
<li><p><strong>preemption_mode</strong> – Preemption mode for KV cache.</p></li>
<li><p><strong>max_num_batched_tokens</strong> – If <code class="docutils literal notranslate"><span class="pre">enable_chunked_prefill</span></code> is set, prefill requests will be chunked based on <code class="docutils literal notranslate"><span class="pre">max_num_batched_tokens</span></code>.</p></li>
<li><p><strong>max_num_seqs</strong> – Maximum number of sequences in a batch.</p></li>
<li><p><strong>kv_cache_dtype</strong> – Data type for kv cache storage.
If <code class="docutils literal notranslate"><span class="pre">auto</span></code>, will use model data type.</p></li>
<li><p><strong>sampling_params</strong> – Sampling parameters to be passed to <code class="docutils literal notranslate"><span class="pre">vllm.SamplingParams</span></code>.</p></li>
<li><p><strong>eval_sampling_params</strong> – Sampling parameters to be used during evaluation.</p></li>
<li><p><strong>disable_log_stats</strong> – Whether to disable logging of vLLM statistics.</p></li>
<li><p><strong>extra_kwargs</strong> – Additional keyword arguments for the <code class="docutils literal notranslate"><span class="pre">vllm.LLM</span></code> constructor.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="phyagi.rl.rollout.vllm_worker_config.VLLMWorkerConfig.to_dict">
<span class="sig-name descname"><span class="pre">to_dict</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/phyagi/rl/rollout/vllm_worker_config.html#VLLMWorkerConfig.to_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#phyagi.rl.rollout.vllm_worker_config.VLLMWorkerConfig.to_dict" title="Link to this definition">#</a></dt>
<dd><p>Convert attributes into a dictionary.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Attributes encoded as a dictionary.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="phyagi.rl.rollout.vllm_worker_config.VLLMWorkerConfig.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prompt_length:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">1024</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">response_length:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">8192</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tensor_parallel_size:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offload:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype:</span> <span class="pre">str</span> <span class="pre">=</span> <span class="pre">'auto'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gpu_memory_utilization:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">0.9</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">swap_space:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">64.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enforce_eager:</span> <span class="pre">bool</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hf_overrides:</span> <span class="pre">~typing.Dict[str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">~typing.Any]</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enable_chunked_prefill:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enable_prefix_caching:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">preemption_mode:</span> <span class="pre">str</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_num_batched_tokens:</span> <span class="pre">int</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_num_seqs:</span> <span class="pre">int</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kv_cache_dtype:</span> <span class="pre">str</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">'auto'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampling_params:</span> <span class="pre">~typing.Dict[str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">~typing.Any]</span> <span class="pre">=</span> <span class="pre">&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval_sampling_params:</span> <span class="pre">~typing.Dict[str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">~typing.Any]</span> <span class="pre">=</span> <span class="pre">&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">disable_log_stats:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extra_kwargs:</span> <span class="pre">~typing.Dict[str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">~typing.Any]</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#phyagi.rl.rollout.vllm_worker_config.VLLMWorkerConfig.__init__" title="Link to this definition">#</a></dt>
<dd></dd></dl>

</dd></dl>

<p id="module-phyagi.rl.rollout.vllm_worker.VLLMWorker">vLLM worker.</p>
<p>This worker is designed to handle model loading, GPU offloading, distributed setup,
and generation via vLLM.</p>
</section>
<section id="tuners">
<h2>Tuners<a class="headerlink" href="#tuners" title="Link to this heading">#</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="phyagi.rl.tuners.ray_worker_config.RayWorkerConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">phyagi.rl.tuners.ray_worker_config.</span></span><span class="sig-name descname"><span class="pre">RayWorkerConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output_dir:</span> <span class="pre">str</span> <span class="pre">|</span> <span class="pre">~pathlib.Path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_nodes:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_gpus_per_node:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do_final_eval:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval_before_training:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epochs:</span> <span class="pre">int</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_steps:</span> <span class="pre">int</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_n_eval_completions:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_steps:</span> <span class="pre">int</span> <span class="pre">|</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_final_checkpoint:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval_steps:</span> <span class="pre">int</span> <span class="pre">|</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">group_size:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_batch_size:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_max_micro_batch_size_per_gpu:</span> <span class="pre">int</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize_advantage_std:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">actor:</span> <span class="pre">~phyagi.rl.models.actor_config.ActorConfig</span> <span class="pre">=</span> <span class="pre">&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rollout:</span> <span class="pre">~phyagi.rl.rollout.vllm_worker_config.VLLMWorkerConfig</span> <span class="pre">=</span> <span class="pre">&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">checkpoint_mode:</span> <span class="pre">~typing.Literal['sync'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">'async']</span> <span class="pre">=</span> <span class="pre">'sync'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataloader_shuffle:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataloader_num_workers:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reward_num_workers:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wandb:</span> <span class="pre">~typing.Dict[str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">~typing.Any]</span> <span class="pre">=</span> <span class="pre">&lt;factory&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/phyagi/rl/tuners/ray_worker_config.html#RayWorkerConfig"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#phyagi.rl.tuners.ray_worker_config.RayWorkerConfig" title="Link to this definition">#</a></dt>
<dd><p>Ray worker configuration.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>output_dir</strong> – Output folder where checkpoints and states will be written.</p></li>
<li><p><strong>n_nodes</strong> – Number of training nodes.</p></li>
<li><p><strong>n_gpus_per_node</strong> – Number of GPUs per node.</p></li>
<li><p><strong>do_final_eval</strong> – Whether to run last step evaluation on the validation set.</p></li>
<li><p><strong>eval_before_training</strong> – Whether to evaluate the model before training.</p></li>
<li><p><strong>epochs</strong> – Number of training epochs.
If <code class="docutils literal notranslate"><span class="pre">None</span></code>, <code class="docutils literal notranslate"><span class="pre">max_steps</span></code> must be set.</p></li>
<li><p><strong>max_steps</strong> – Maximum number of training steps.
If <code class="docutils literal notranslate"><span class="pre">None</span></code>, <code class="docutils literal notranslate"><span class="pre">epochs</span></code> must be set.</p></li>
<li><p><strong>log_n_eval_completions</strong> – Number of completions for questions from the validation set to save on each evaluation step.
If <code class="docutils literal notranslate"><span class="pre">-1</span></code>, all completions are saved.</p></li>
<li><p><strong>save_steps</strong> – Number of steps between checkpoints.
If set to range <code class="docutils literal notranslate"><span class="pre">[0,</span> <span class="pre">1)</span></code>, will be interpreted as a ratio of total training steps.</p></li>
<li><p><strong>save_final_checkpoint</strong> – Whether to save last step checkpoint.</p></li>
<li><p><strong>eval_steps</strong> – Number of steps between evaluations.
If set to range <code class="docutils literal notranslate"><span class="pre">[0,</span> <span class="pre">1)</span></code>, will be interpreted as a ratio of total training steps.</p></li>
<li><p><strong>seed</strong> – Random seed.</p></li>
<li><p><strong>group_size</strong> – Group size (completions per question).</p></li>
<li><p><strong>train_batch_size</strong> – Number of questions used in each round.
Must be divisible by <code class="docutils literal notranslate"><span class="pre">world_size</span></code>.</p></li>
<li><p><strong>train_max_micro_batch_size_per_gpu</strong> – Maximum micro-batch size of packed documents per GPU.
If <code class="docutils literal notranslate"><span class="pre">None</span></code>, tries to fit the entire batch (<code class="docutils literal notranslate"><span class="pre">train_batch_size</span> <span class="pre">*</span> <span class="pre">group_size</span> <span class="pre">/</span> <span class="pre">[n_nodes</span> <span class="pre">*</span> <span class="pre">n_gpus_per_node]</span></code> documents in the worst case) on each GPU.</p></li>
<li><p><strong>normalize_advantage_std</strong> – Whether to normalize the advantages standard deviation.</p></li>
<li><p><strong>actor</strong> – Actor configuration.</p></li>
<li><p><strong>rollout</strong> – Rollout configuration.</p></li>
<li><p><strong>checkpoint_mode</strong> – Checkpointing mode.</p></li>
<li><p><strong>dataloader_shuffle</strong> – Whether to shuffle the data loader (training).</p></li>
<li><p><strong>dataloader_num_workers</strong> – Number of subprocesses to use for data loading.</p></li>
<li><p><strong>reward_num_workers</strong> – Number of reward workers.</p></li>
<li><p><strong>wandb</strong> – WandB configuration.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="phyagi.rl.tuners.ray_worker_config.RayWorkerConfig.to_dict">
<span class="sig-name descname"><span class="pre">to_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">json_serialize</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/phyagi/rl/tuners/ray_worker_config.html#RayWorkerConfig.to_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#phyagi.rl.tuners.ray_worker_config.RayWorkerConfig.to_dict" title="Link to this definition">#</a></dt>
<dd><p>Convert attributes into a dictionary.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>json_serialize</strong> – Whether to serialize non-compatible types into native types supported by JSON.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Attributes encoded as a dictionary.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="phyagi.rl.tuners.ray_worker_config.RayWorkerConfig.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output_dir:</span> <span class="pre">str</span> <span class="pre">|</span> <span class="pre">~pathlib.Path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_nodes:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_gpus_per_node:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do_final_eval:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval_before_training:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epochs:</span> <span class="pre">int</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_steps:</span> <span class="pre">int</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_n_eval_completions:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_steps:</span> <span class="pre">int</span> <span class="pre">|</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_final_checkpoint:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval_steps:</span> <span class="pre">int</span> <span class="pre">|</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">group_size:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_batch_size:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_max_micro_batch_size_per_gpu:</span> <span class="pre">int</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize_advantage_std:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">actor:</span> <span class="pre">~phyagi.rl.models.actor_config.ActorConfig</span> <span class="pre">=</span> <span class="pre">&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rollout:</span> <span class="pre">~phyagi.rl.rollout.vllm_worker_config.VLLMWorkerConfig</span> <span class="pre">=</span> <span class="pre">&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">checkpoint_mode:</span> <span class="pre">~typing.Literal['sync'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">'async']</span> <span class="pre">=</span> <span class="pre">'sync'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataloader_shuffle:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataloader_num_workers:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reward_num_workers:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wandb:</span> <span class="pre">~typing.Dict[str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">~typing.Any]</span> <span class="pre">=</span> <span class="pre">&lt;factory&gt;</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#phyagi.rl.tuners.ray_worker_config.RayWorkerConfig.__init__" title="Link to this definition">#</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="phyagi.rl.tuners.ray_worker.RayWorker">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">phyagi.rl.tuners.ray_worker.</span></span><span class="sig-name descname"><span class="pre">RayWorker</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#phyagi.rl.tuners.ray_worker_config.RayWorkerConfig" title="phyagi.rl.tuners.ray_worker_config.RayWorkerConfig"><span class="pre">RayWorkerConfig</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">checkpoint_manager</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="utils.html#phyagi.utils.checkpoint.CheckpointManager" title="phyagi.utils.checkpoint.CheckpointManager"><span class="pre">CheckpointManager</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">distributed_layout</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DistributedLayout</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tokenizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">PreTrainedTokenizerBase</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skip_process_group_init</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">total_training_steps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/phyagi/rl/tuners/ray_worker.html#RayWorker"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#phyagi.rl.tuners.ray_worker.RayWorker" title="Link to this definition">#</a></dt>
<dd><p>Ray worker.</p>
<dl class="py method">
<dt class="sig sig-object py" id="phyagi.rl.tuners.ray_worker.RayWorker.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#phyagi.rl.tuners.ray_worker_config.RayWorkerConfig" title="phyagi.rl.tuners.ray_worker_config.RayWorkerConfig"><span class="pre">RayWorkerConfig</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">checkpoint_manager</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="utils.html#phyagi.utils.checkpoint.CheckpointManager" title="phyagi.utils.checkpoint.CheckpointManager"><span class="pre">CheckpointManager</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">distributed_layout</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DistributedLayout</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tokenizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">PreTrainedTokenizerBase</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skip_process_group_init</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">total_training_steps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/phyagi/rl/tuners/ray_worker.html#RayWorker.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#phyagi.rl.tuners.ray_worker.RayWorker.__init__" title="Link to this definition">#</a></dt>
<dd><p>Initialize the worker.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>config</strong> – Ray worker configuration.</p></li>
<li><p><strong>checkpoint_manager</strong> – Checkpoint manager for saving/loading checkpoints.</p></li>
<li><p><strong>distributed_layout</strong> – Distributed layout for the worker.</p></li>
<li><p><strong>tokenizer</strong> – Tokenizer to use.</p></li>
<li><p><strong>skip_process_group_init</strong> – Whether to skip process group initialization.</p></li>
<li><p><strong>total_training_steps</strong> – Total number of training steps.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="phyagi.rl.tuners.ray_worker.RayWorker.configure_models">
<span class="sig-name descname"><span class="pre">configure_models</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_reference_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_rollout</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/phyagi/rl/tuners/ray_worker.html#RayWorker.configure_models"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#phyagi.rl.tuners.ray_worker.RayWorker.configure_models" title="Link to this definition">#</a></dt>
<dd><p>Configure the models initialization.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_reference_model</strong> – Whether to build the reference model.</p></li>
<li><p><strong>build_rollout</strong> – Whether to build the rollout model.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="phyagi.rl.tuners.ray_worker.RayWorker.save_actor_model">
<span class="sig-name descname"><span class="pre">save_actor_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">checkpoint_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Path</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/phyagi/rl/tuners/ray_worker.html#RayWorker.save_actor_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#phyagi.rl.tuners.ray_worker.RayWorker.save_actor_model" title="Link to this definition">#</a></dt>
<dd><p>Save the actor model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>checkpoint_path</strong> – Path to save the checkpoint.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="phyagi.rl.tuners.ray_worker.RayWorker.load_actor_model">
<span class="sig-name descname"><span class="pre">load_actor_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">checkpoint_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">load_optimizer_states</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">load_scheduler_states</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/phyagi/rl/tuners/ray_worker.html#RayWorker.load_actor_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#phyagi.rl.tuners.ray_worker.RayWorker.load_actor_model" title="Link to this definition">#</a></dt>
<dd><p>Load the actor model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>checkpoint_dir</strong> – Path to the checkpoint directory.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="phyagi.rl.tuners.ray_worker.RayWorker.save_reference_model">
<span class="sig-name descname"><span class="pre">save_reference_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">checkpoint_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Path</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/phyagi/rl/tuners/ray_worker.html#RayWorker.save_reference_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#phyagi.rl.tuners.ray_worker.RayWorker.save_reference_model" title="Link to this definition">#</a></dt>
<dd><p>Save the reference model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>checkpoint_dir</strong> – Path to save the checkpoint.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="phyagi.rl.tuners.ray_worker.RayWorker.load_reference_model">
<span class="sig-name descname"><span class="pre">load_reference_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">checkpoint_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Path</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/phyagi/rl/tuners/ray_worker.html#RayWorker.load_reference_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#phyagi.rl.tuners.ray_worker.RayWorker.load_reference_model" title="Link to this definition">#</a></dt>
<dd><p>Load the reference model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>checkpoint_dir</strong> – Path to the checkpoint directory.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="phyagi.rl.tuners.ray_worker.RayWorker.generate_completions">
<span class="sig-name descname"><span class="pre">generate_completions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prompts</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_repetitions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sync_weights</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_tqdm</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">generation_kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">vllm.RequestOutput</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/phyagi/rl/tuners/ray_worker.html#RayWorker.generate_completions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#phyagi.rl.tuners.ray_worker.RayWorker.generate_completions" title="Link to this definition">#</a></dt>
<dd><p>Generate completions for the given prompts.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>prompts</strong> – Input prompts to generate completions for.</p></li>
<li><p><strong>num_repetitions</strong> – Number of repetitions for each prompt.</p></li>
<li><p><strong>sync_weights</strong> – Whether to synchronize weights with the rollout model.</p></li>
<li><p><strong>batch_size</strong> – Batch size for generation.</p></li>
<li><p><strong>use_tqdm</strong> – Whether to use <code class="docutils literal notranslate"><span class="pre">tqdm</span></code> for progress bar.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List of generated completions.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="phyagi.rl.tuners.ray_worker.RayWorker.compute_loss">
<span class="sig-name descname"><span class="pre">compute_loss</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="reference internal" href="../_modules/phyagi/rl/tuners/ray_worker.html#RayWorker.compute_loss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#phyagi.rl.tuners.ray_worker.RayWorker.compute_loss" title="Link to this definition">#</a></dt>
<dd><p>Compute the loss.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="phyagi.rl.tuners.ray_worker.RayWorker.update_actor_policy">
<span class="sig-name descname"><span class="pre">update_actor_policy</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/phyagi/rl/tuners/ray_worker.html#RayWorker.update_actor_policy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#phyagi.rl.tuners.ray_worker.RayWorker.update_actor_policy" title="Link to this definition">#</a></dt>
<dd><p>Update the actor policy.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dictionary containing training metrics.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<section id="hugging-face">
<h3>Hugging Face<a class="headerlink" href="#hugging-face" title="Link to this heading">#</a></h3>
</section>
<section id="grpo">
<h3>GRPO<a class="headerlink" href="#grpo" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="phyagi.rl.tuners.grpo.grpo_config.RayGRPOConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">phyagi.rl.tuners.grpo.grpo_config.</span></span><span class="sig-name descname"><span class="pre">RayGRPOConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output_dir:</span> <span class="pre">str</span> <span class="pre">|</span> <span class="pre">~pathlib.Path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_nodes:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_gpus_per_node:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do_final_eval:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval_before_training:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epochs:</span> <span class="pre">int</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_steps:</span> <span class="pre">int</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_n_eval_completions:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_steps:</span> <span class="pre">int</span> <span class="pre">|</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_final_checkpoint:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval_steps:</span> <span class="pre">int</span> <span class="pre">|</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">group_size:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_batch_size:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_max_micro_batch_size_per_gpu:</span> <span class="pre">int</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize_advantage_std:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">actor:</span> <span class="pre">~phyagi.rl.models.actor_config.ActorConfig</span> <span class="pre">=</span> <span class="pre">&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rollout:</span> <span class="pre">~phyagi.rl.rollout.vllm_worker_config.VLLMWorkerConfig</span> <span class="pre">=</span> <span class="pre">&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">checkpoint_mode:</span> <span class="pre">~typing.Literal['sync'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">'async']</span> <span class="pre">=</span> <span class="pre">'sync'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataloader_shuffle:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataloader_num_workers:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reward_num_workers:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wandb:</span> <span class="pre">~typing.Dict[str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">~typing.Any]</span> <span class="pre">=</span> <span class="pre">&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval_group_size:</span> <span class="pre">int</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval_batch_size:</span> <span class="pre">int</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss_normalization:</span> <span class="pre">~typing.Literal['batch'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">'sequence'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">'max_context']</span> <span class="pre">=</span> <span class="pre">'batch'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_policy_updates_per_batch:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kl_coeff:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">entropy_coeff:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon_low:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon_high:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">0.2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/phyagi/rl/tuners/grpo/grpo_config.html#RayGRPOConfig"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#phyagi.rl.tuners.grpo.grpo_config.RayGRPOConfig" title="Link to this definition">#</a></dt>
<dd><p>Ray GRPO configuration.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>eval_group_size</strong> – Group size (completions per question) used during mid-training evaluation.
If <code class="docutils literal notranslate"><span class="pre">None</span></code>, defaults to <code class="docutils literal notranslate"><span class="pre">group_size</span></code>.</p></li>
<li><p><strong>eval_batch_size</strong> – Batch size for evaluation.
If <code class="docutils literal notranslate"><span class="pre">None</span></code>, no batching is applied and all sequences are passed to vLLM.</p></li>
<li><p><strong>loss_normalization</strong> – Method to normalize the loss.
<code class="docutils literal notranslate"><span class="pre">batch</span></code> normalizes by the number of valid tokens in the packed batch,
<code class="docutils literal notranslate"><span class="pre">sequence</span></code> normalizes by the number of valid tokens in each sequence.
<code class="docutils literal notranslate"><span class="pre">max_context</span></code> normalizes by the maximum context length accepted (<code class="docutils literal notranslate"><span class="pre">rollout.prompt_length</span></code> + <code class="docutils literal notranslate"><span class="pre">rollout.response_length</span></code>)</p></li>
<li><p><strong>num_policy_updates_per_batch</strong> – Number of policy updates per batch (‘mu’).</p></li>
<li><p><strong>kl_coeff</strong> – KL divergence term coefficient (‘beta’).</p></li>
<li><p><strong>entropy_coeff</strong> – Entropy coefficient for the policy loss. By default (<code class="docutils literal notranslate"><span class="pre">entropy_coeff=0.0</span></code>), disable entropy regularization.</p></li>
<li><p><strong>epsilon_low</strong> – Minimum epsilon clip value.</p></li>
<li><p><strong>epsilon_high</strong> – Maximum epsilon clip value.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="phyagi.rl.tuners.grpo.grpo_config.RayGRPOConfig.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output_dir:</span> <span class="pre">str</span> <span class="pre">|</span> <span class="pre">~pathlib.Path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_nodes:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_gpus_per_node:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do_final_eval:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval_before_training:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epochs:</span> <span class="pre">int</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_steps:</span> <span class="pre">int</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_n_eval_completions:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_steps:</span> <span class="pre">int</span> <span class="pre">|</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_final_checkpoint:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval_steps:</span> <span class="pre">int</span> <span class="pre">|</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">group_size:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_batch_size:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_max_micro_batch_size_per_gpu:</span> <span class="pre">int</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize_advantage_std:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">actor:</span> <span class="pre">~phyagi.rl.models.actor_config.ActorConfig</span> <span class="pre">=</span> <span class="pre">&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rollout:</span> <span class="pre">~phyagi.rl.rollout.vllm_worker_config.VLLMWorkerConfig</span> <span class="pre">=</span> <span class="pre">&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">checkpoint_mode:</span> <span class="pre">~typing.Literal['sync'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">'async']</span> <span class="pre">=</span> <span class="pre">'sync'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataloader_shuffle:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataloader_num_workers:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reward_num_workers:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wandb:</span> <span class="pre">~typing.Dict[str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">~typing.Any]</span> <span class="pre">=</span> <span class="pre">&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval_group_size:</span> <span class="pre">int</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval_batch_size:</span> <span class="pre">int</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss_normalization:</span> <span class="pre">~typing.Literal['batch'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">'sequence'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">'max_context']</span> <span class="pre">=</span> <span class="pre">'batch'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_policy_updates_per_batch:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kl_coeff:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">entropy_coeff:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon_low:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon_high:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">0.2</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#phyagi.rl.tuners.grpo.grpo_config.RayGRPOConfig.__init__" title="Link to this definition">#</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="phyagi.rl.tuners.grpo.grpo_worker.RayGRPOWorker">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">phyagi.rl.tuners.grpo.grpo_worker.</span></span><span class="sig-name descname"><span class="pre">RayGRPOWorker</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#phyagi.rl.tuners.grpo.grpo_config.RayGRPOConfig" title="phyagi.rl.tuners.grpo.grpo_config.RayGRPOConfig"><span class="pre">RayGRPOConfig</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">checkpoint_manager</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="utils.html#phyagi.utils.checkpoint.CheckpointManager" title="phyagi.utils.checkpoint.CheckpointManager"><span class="pre">CheckpointManager</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">distributed_layout</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DistributedLayout</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tokenizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">PreTrainedTokenizerBase</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skip_process_group_init</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">total_training_steps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/phyagi/rl/tuners/grpo/grpo_worker.html#RayGRPOWorker"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#phyagi.rl.tuners.grpo.grpo_worker.RayGRPOWorker" title="Link to this definition">#</a></dt>
<dd><p>Ray GRPO worker.</p>
<dl class="py method">
<dt class="sig sig-object py" id="phyagi.rl.tuners.grpo.grpo_worker.RayGRPOWorker.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#phyagi.rl.tuners.grpo.grpo_config.RayGRPOConfig" title="phyagi.rl.tuners.grpo.grpo_config.RayGRPOConfig"><span class="pre">RayGRPOConfig</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">checkpoint_manager</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="utils.html#phyagi.utils.checkpoint.CheckpointManager" title="phyagi.utils.checkpoint.CheckpointManager"><span class="pre">CheckpointManager</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">distributed_layout</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DistributedLayout</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tokenizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">PreTrainedTokenizerBase</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skip_process_group_init</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">total_training_steps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/phyagi/rl/tuners/grpo/grpo_worker.html#RayGRPOWorker.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#phyagi.rl.tuners.grpo.grpo_worker.RayGRPOWorker.__init__" title="Link to this definition">#</a></dt>
<dd><p>Initialize the worker.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>config</strong> – GRPO configuration.</p></li>
<li><p><strong>checkpoint_manager</strong> – Checkpoint manager for saving/loading checkpoints.</p></li>
<li><p><strong>distributed_layout</strong> – Distributed layout for the worker.</p></li>
<li><p><strong>tokenizer</strong> – Tokenizer to use.</p></li>
<li><p><strong>skip_process_group_init</strong> – Whether to skip process group initialization.</p></li>
<li><p><strong>total_training_steps</strong> – Total number of training steps.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="phyagi.rl.tuners.grpo.grpo_worker.RayGRPOWorker.compute_loss">
<span class="sig-name descname"><span class="pre">compute_loss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">per_token_logps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">FloatTensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">completion_mask</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">BoolTensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ref_per_token_logps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">FloatTensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">old_per_token_logps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">FloatTensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">advantages</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">FloatTensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">entropy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">FloatTensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss_scale</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">FloatTensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">FloatTensor</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/phyagi/rl/tuners/grpo/grpo_worker.html#RayGRPOWorker.compute_loss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#phyagi.rl.tuners.grpo.grpo_worker.RayGRPOWorker.compute_loss" title="Link to this definition">#</a></dt>
<dd><p>Compute the GRPO loss.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>per_token_logps</strong> – Per-token log probabilities.</p></li>
<li><p><strong>completion_mask</strong> – Completion mask.</p></li>
<li><p><strong>ref_per_token_logps</strong> – Reference per-token log probabilities.</p></li>
<li><p><strong>old_per_token_logps</strong> – Old per-token log probabilities.</p></li>
<li><p><strong>advantages</strong> – Advantages.</p></li>
<li><p><strong>entropy</strong> – Optional average entropy for the batch.</p></li>
<li><p><strong>loss_scale</strong> – Loss scaling factor.
If <code class="docutils literal notranslate"><span class="pre">float</span></code>, it is scaled by this <code class="docutils literal notranslate"><span class="pre">batch_size</span></code>.
If <code class="docutils literal notranslate"><span class="pre">None</span></code>, it is scaled by the number of valid tokens in the packed batch.
If a tensor of the same shape as <code class="docutils literal notranslate"><span class="pre">completion_mask</span></code>, it is scaled by the corresponding value.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple with loss and dictionary of metrics (mean KL divergence, clip ratio, and entropy).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="phyagi.rl.tuners.grpo.grpo_worker.RayGRPOWorker.update_actor_policy">
<span class="sig-name descname"><span class="pre">update_actor_policy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">packed_batches</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="datasets.html#phyagi.datasets.rl.packing.PackedBatch" title="phyagi.datasets.rl.packing.PackedBatch"><span class="pre">PackedBatch</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temperature</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/phyagi/rl/tuners/grpo/grpo_worker.html#RayGRPOWorker.update_actor_policy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#phyagi.rl.tuners.grpo.grpo_worker.RayGRPOWorker.update_actor_policy" title="Link to this definition">#</a></dt>
<dd><p>Update the actor policy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>packed_batches</strong> – List of packed batches.</p></li>
<li><p><strong>temperature</strong> – Temperature for the actor’s log probabilities.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Training loss, learning rate, mean KL divergence, clip ratio, and gradient norm.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="phyagi.rl.tuners.grpo.grpo_tuner.RayGRPOTuner">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">phyagi.rl.tuners.grpo.grpo_tuner.</span></span><span class="sig-name descname"><span class="pre">RayGRPOTuner</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#phyagi.rl.tuners.grpo.grpo_config.RayGRPOConfig" title="phyagi.rl.tuners.grpo.grpo_config.RayGRPOConfig"><span class="pre">RayGRPOConfig</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tokenizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">PreTrainedTokenizerBase</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_collator</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dataset</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval_dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dataset</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rewards</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#phyagi.rl.rewards.reward.Reward" title="phyagi.rl.rewards.reward.Reward"><span class="pre">Reward</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/phyagi/rl/tuners/grpo/grpo_tuner.html#RayGRPOTuner"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#phyagi.rl.tuners.grpo.grpo_tuner.RayGRPOTuner" title="Link to this definition">#</a></dt>
<dd><p>Ray GRPO tuner.</p>
<dl class="py method">
<dt class="sig sig-object py" id="phyagi.rl.tuners.grpo.grpo_tuner.RayGRPOTuner.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#phyagi.rl.tuners.grpo.grpo_config.RayGRPOConfig" title="phyagi.rl.tuners.grpo.grpo_config.RayGRPOConfig"><span class="pre">RayGRPOConfig</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tokenizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">PreTrainedTokenizerBase</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_collator</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dataset</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval_dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dataset</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rewards</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#phyagi.rl.rewards.reward.Reward" title="phyagi.rl.rewards.reward.Reward"><span class="pre">Reward</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/phyagi/rl/tuners/grpo/grpo_tuner.html#RayGRPOTuner.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#phyagi.rl.tuners.grpo.grpo_tuner.RayGRPOTuner.__init__" title="Link to this definition">#</a></dt>
<dd><p>Initialize the tuner.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>args</strong> – GRPO tuning arguments.</p></li>
<li><p><strong>tokenizer</strong> – Tokenizer used for encoding the dataset.</p></li>
<li><p><strong>data_collator</strong> – Collate function used for creating a batch from <code class="docutils literal notranslate"><span class="pre">train_dataset</span></code> and <code class="docutils literal notranslate"><span class="pre">eval_dataset</span></code>.</p></li>
<li><p><strong>train_dataset</strong> – Dataset used for training.
If set to <code class="docutils literal notranslate"><span class="pre">None</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">train()</span></code> will not be available.</p></li>
<li><p><strong>eval_dataset</strong> – Dataset used for evaluation.
If set to <code class="docutils literal notranslate"><span class="pre">None</span></code>, will not perform evaluation.</p></li>
<li><p><strong>rewards</strong> – Dictionary of reward functions.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="phyagi.rl.tuners.grpo.grpo_tuner.RayGRPOTuner.get_train_dataloader">
<span class="sig-name descname"><span class="pre">get_train_dataloader</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">total_consumed_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shuffle</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataLoader</span></span></span><a class="reference internal" href="../_modules/phyagi/rl/tuners/grpo/grpo_tuner.html#RayGRPOTuner.get_train_dataloader"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#phyagi.rl.tuners.grpo.grpo_tuner.RayGRPOTuner.get_train_dataloader" title="Link to this definition">#</a></dt>
<dd><p>Get the training dataloader.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>total_consumed_samples</strong> – Total number of samples consumed so far.</p></li>
<li><p><strong>shuffle</strong> – Whether to shuffle the dataset.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Training dataloader.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="phyagi.rl.tuners.grpo.grpo_tuner.RayGRPOTuner.generate_completions">
<span class="sig-name descname"><span class="pre">generate_completions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prompt_input_ids</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_repetitions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sync_weights</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">generation_kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">vllm.CompletionOutput</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/phyagi/rl/tuners/grpo/grpo_tuner.html#RayGRPOTuner.generate_completions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#phyagi.rl.tuners.grpo.grpo_tuner.RayGRPOTuner.generate_completions" title="Link to this definition">#</a></dt>
<dd><p>Generate completions for the given prompts.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>prompt_input_ids</strong> – Input prompts to generate completions for.</p></li>
<li><p><strong>num_repetitions</strong> – Number of repetitions for each prompt.</p></li>
<li><p><strong>sync_weights</strong> – Whether to synchronize weights with the rollout model.</p></li>
<li><p><strong>batch_size</strong> – Batch size for generation.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List of lists of completion outputs, where each inner list corresponds to a prompt and contains
the generated completions.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="phyagi.rl.tuners.grpo.grpo_tuner.RayGRPOTuner.save_checkpoint">
<span class="sig-name descname"><span class="pre">save_checkpoint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrite_reference_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/phyagi/rl/tuners/grpo/grpo_tuner.html#RayGRPOTuner.save_checkpoint"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#phyagi.rl.tuners.grpo.grpo_tuner.RayGRPOTuner.save_checkpoint" title="Link to this definition">#</a></dt>
<dd><p>Save the current state of the tuner.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>output_dir</strong> – Directory to save the checkpoint.</p></li>
<li><p><strong>overwrite_reference_model</strong> – Whether to overwrite the reference model if it already exists.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="phyagi.rl.tuners.grpo.grpo_tuner.RayGRPOTuner.load_checkpoint">
<span class="sig-name descname"><span class="pre">load_checkpoint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">load_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tag</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">load_optimizer_states</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">load_scheduler_states</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/phyagi/rl/tuners/grpo/grpo_tuner.html#RayGRPOTuner.load_checkpoint"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#phyagi.rl.tuners.grpo.grpo_tuner.RayGRPOTuner.load_checkpoint" title="Link to this definition">#</a></dt>
<dd><p>Load a checkpoint from the specified directory.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>load_dir</strong> – Directory to load the checkpoint from.</p></li>
<li><p><strong>tag</strong> – Tag of the checkpoint to load.
If set to <code class="docutils literal notranslate"><span class="pre">None</span></code>, it will load the latest checkpoint available in the directory.</p></li>
<li><p><strong>load_optimizer_states</strong> – Whether to load optimizer states from the checkpoint.</p></li>
<li><p><strong>load_scheduler_states</strong> – Whether to load learning rate scheduler states from the checkpoint.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Trainer state dictionary containing the global step, total consumed samples,
dataloader shuffle state, and seed used for training.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="phyagi.rl.tuners.grpo.grpo_tuner.RayGRPOTuner.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/phyagi/rl/tuners/grpo/grpo_tuner.html#RayGRPOTuner.evaluate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#phyagi.rl.tuners.grpo.grpo_tuner.RayGRPOTuner.evaluate" title="Link to this definition">#</a></dt>
<dd><p>Evaluate the model on the evaluation dataset.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Evaluation metrics containing the rewards and other statistics.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="isft">
<h3>ISFT<a class="headerlink" href="#isft" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="phyagi.rl.tuners.isft.isft_config.RayISFTConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">phyagi.rl.tuners.isft.isft_config.</span></span><span class="sig-name descname"><span class="pre">RayISFTConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output_dir:</span> <span class="pre">str</span> <span class="pre">|</span> <span class="pre">~pathlib.Path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_nodes:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_gpus_per_node:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do_final_eval:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval_before_training:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epochs:</span> <span class="pre">int</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_steps:</span> <span class="pre">int</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_n_eval_completions:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_steps:</span> <span class="pre">int</span> <span class="pre">|</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_final_checkpoint:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval_steps:</span> <span class="pre">int</span> <span class="pre">|</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">group_size:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_batch_size:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_max_micro_batch_size_per_gpu:</span> <span class="pre">int</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize_advantage_std:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">actor:</span> <span class="pre">~phyagi.rl.models.actor_config.ActorConfig</span> <span class="pre">=</span> <span class="pre">&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rollout:</span> <span class="pre">~phyagi.rl.rollout.vllm_worker_config.VLLMWorkerConfig</span> <span class="pre">=</span> <span class="pre">&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">checkpoint_mode:</span> <span class="pre">~typing.Literal['sync'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">'async']</span> <span class="pre">=</span> <span class="pre">'sync'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataloader_shuffle:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataloader_num_workers:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reward_num_workers:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wandb:</span> <span class="pre">~typing.Dict[str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">~typing.Any]</span> <span class="pre">=</span> <span class="pre">&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">generation_interval:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/phyagi/rl/tuners/isft/isft_config.html#RayISFTConfig"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#phyagi.rl.tuners.isft.isft_config.RayISFTConfig" title="Link to this definition">#</a></dt>
<dd><p>Ray ISFT configuration.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>generation_interval</strong> – Number of steps between rollout generations.
This parameter will define how much data is generated and how often the model weights are
synchronized with the rollouts. During a generation step (that occurs after every <code class="docutils literal notranslate"><span class="pre">generation_interval</span></code> steps),
the trainer will generate <code class="docutils literal notranslate"><span class="pre">generation_interval</span> <span class="pre">*</span> <span class="pre">train_batch_size</span> <span class="pre">*</span> <span class="pre">group_size</span></code> completions that
will be used to perform the next <code class="docutils literal notranslate"><span class="pre">generation_interval</span></code> actor model updates.”</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="phyagi.rl.tuners.isft.isft_config.RayISFTConfig.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output_dir:</span> <span class="pre">str</span> <span class="pre">|</span> <span class="pre">~pathlib.Path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_nodes:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_gpus_per_node:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do_final_eval:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval_before_training:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epochs:</span> <span class="pre">int</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_steps:</span> <span class="pre">int</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_n_eval_completions:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_steps:</span> <span class="pre">int</span> <span class="pre">|</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_final_checkpoint:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval_steps:</span> <span class="pre">int</span> <span class="pre">|</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">group_size:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_batch_size:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_max_micro_batch_size_per_gpu:</span> <span class="pre">int</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize_advantage_std:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">actor:</span> <span class="pre">~phyagi.rl.models.actor_config.ActorConfig</span> <span class="pre">=</span> <span class="pre">&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rollout:</span> <span class="pre">~phyagi.rl.rollout.vllm_worker_config.VLLMWorkerConfig</span> <span class="pre">=</span> <span class="pre">&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">checkpoint_mode:</span> <span class="pre">~typing.Literal['sync'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">'async']</span> <span class="pre">=</span> <span class="pre">'sync'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataloader_shuffle:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataloader_num_workers:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reward_num_workers:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wandb:</span> <span class="pre">~typing.Dict[str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">~typing.Any]</span> <span class="pre">=</span> <span class="pre">&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">generation_interval:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">1</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#phyagi.rl.tuners.isft.isft_config.RayISFTConfig.__init__" title="Link to this definition">#</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="phyagi.rl.tuners.isft.isft_worker.RayISFTWorker">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">phyagi.rl.tuners.isft.isft_worker.</span></span><span class="sig-name descname"><span class="pre">RayISFTWorker</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#phyagi.rl.tuners.isft.isft_config.RayISFTConfig" title="phyagi.rl.tuners.isft.isft_config.RayISFTConfig"><span class="pre">RayISFTConfig</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">checkpoint_manager</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="utils.html#phyagi.utils.checkpoint.CheckpointManager" title="phyagi.utils.checkpoint.CheckpointManager"><span class="pre">CheckpointManager</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">distributed_layout</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DistributedLayout</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tokenizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">PreTrainedTokenizerBase</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skip_process_group_init</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">total_training_steps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/phyagi/rl/tuners/isft/isft_worker.html#RayISFTWorker"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#phyagi.rl.tuners.isft.isft_worker.RayISFTWorker" title="Link to this definition">#</a></dt>
<dd><p>Ray ISFT worker.</p>
<dl class="py method">
<dt class="sig sig-object py" id="phyagi.rl.tuners.isft.isft_worker.RayISFTWorker.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#phyagi.rl.tuners.isft.isft_config.RayISFTConfig" title="phyagi.rl.tuners.isft.isft_config.RayISFTConfig"><span class="pre">RayISFTConfig</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">checkpoint_manager</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="utils.html#phyagi.utils.checkpoint.CheckpointManager" title="phyagi.utils.checkpoint.CheckpointManager"><span class="pre">CheckpointManager</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">distributed_layout</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DistributedLayout</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tokenizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">PreTrainedTokenizerBase</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skip_process_group_init</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">total_training_steps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/phyagi/rl/tuners/isft/isft_worker.html#RayISFTWorker.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#phyagi.rl.tuners.isft.isft_worker.RayISFTWorker.__init__" title="Link to this definition">#</a></dt>
<dd><p>Initialize the worker.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>config</strong> – ISFT configuration.</p></li>
<li><p><strong>checkpoint_manager</strong> – Checkpoint manager for saving/loading checkpoints.</p></li>
<li><p><strong>distributed_layout</strong> – Distributed layout for the worker.</p></li>
<li><p><strong>tokenizer</strong> – Tokenizer to use.</p></li>
<li><p><strong>skip_process_group_init</strong> – Whether to skip process group initialization.</p></li>
<li><p><strong>total_training_steps</strong> – Total number of training steps.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="phyagi.rl.tuners.isft.isft_worker.RayISFTWorker.configure_models">
<span class="sig-name descname"><span class="pre">configure_models</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/phyagi/rl/tuners/isft/isft_worker.html#RayISFTWorker.configure_models"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#phyagi.rl.tuners.isft.isft_worker.RayISFTWorker.configure_models" title="Link to this definition">#</a></dt>
<dd><p>Configure the models initialization.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_reference_model</strong> – Whether to build the reference model.</p></li>
<li><p><strong>build_rollout</strong> – Whether to build the rollout model.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="phyagi.rl.tuners.isft.isft_worker.RayISFTWorker.compute_loss">
<span class="sig-name descname"><span class="pre">compute_loss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">per_token_logps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">FloatTensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">completion_mask</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">BoolTensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">advantages</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">FloatTensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">FloatTensor</span></span></span><a class="reference internal" href="../_modules/phyagi/rl/tuners/isft/isft_worker.html#RayISFTWorker.compute_loss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#phyagi.rl.tuners.isft.isft_worker.RayISFTWorker.compute_loss" title="Link to this definition">#</a></dt>
<dd><p>Compute the loss.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>per_token_logps</strong> – Per-token log probabilities.</p></li>
<li><p><strong>completion_mask</strong> – Completion mask.</p></li>
<li><p><strong>advantages</strong> – Advantages.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Loss value.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="phyagi.rl.tuners.isft.isft_worker.RayISFTWorker.update_actor_policy">
<span class="sig-name descname"><span class="pre">update_actor_policy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">packed_batches</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="datasets.html#phyagi.datasets.rl.packing.PackedBatch" title="phyagi.datasets.rl.packing.PackedBatch"><span class="pre">PackedBatch</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temperature</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/phyagi/rl/tuners/isft/isft_worker.html#RayISFTWorker.update_actor_policy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#phyagi.rl.tuners.isft.isft_worker.RayISFTWorker.update_actor_policy" title="Link to this definition">#</a></dt>
<dd><p>Update the actor policy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>packed_batches</strong> – List of packed batches.</p></li>
<li><p><strong>temperature</strong> – Temperature for sampling.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Training loss, learning rate, and gradient norm.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="phyagi.rl.tuners.isft.isft_tuner.RayISFTTuner">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">phyagi.rl.tuners.isft.isft_tuner.</span></span><span class="sig-name descname"><span class="pre">RayISFTTuner</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#phyagi.rl.tuners.isft.isft_config.RayISFTConfig" title="phyagi.rl.tuners.isft.isft_config.RayISFTConfig"><span class="pre">RayISFTConfig</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tokenizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">PreTrainedTokenizerBase</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_collator</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dataset</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval_dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dataset</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rewards</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#phyagi.rl.rewards.reward.Reward" title="phyagi.rl.rewards.reward.Reward"><span class="pre">Reward</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/phyagi/rl/tuners/isft/isft_tuner.html#RayISFTTuner"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#phyagi.rl.tuners.isft.isft_tuner.RayISFTTuner" title="Link to this definition">#</a></dt>
<dd><p>Ray ISFT tuner.</p>
<dl class="py method">
<dt class="sig sig-object py" id="phyagi.rl.tuners.isft.isft_tuner.RayISFTTuner.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#phyagi.rl.tuners.isft.isft_config.RayISFTConfig" title="phyagi.rl.tuners.isft.isft_config.RayISFTConfig"><span class="pre">RayISFTConfig</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tokenizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">PreTrainedTokenizerBase</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_collator</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dataset</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval_dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dataset</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rewards</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#phyagi.rl.rewards.reward.Reward" title="phyagi.rl.rewards.reward.Reward"><span class="pre">Reward</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/phyagi/rl/tuners/isft/isft_tuner.html#RayISFTTuner.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#phyagi.rl.tuners.isft.isft_tuner.RayISFTTuner.__init__" title="Link to this definition">#</a></dt>
<dd><p>Initialize the tuner.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>args</strong> – ISFT tuning arguments.</p></li>
<li><p><strong>tokenizer</strong> – Tokenizer used for encoding the dataset.</p></li>
<li><p><strong>data_collator</strong> – Collate function used for creating a batch from <code class="docutils literal notranslate"><span class="pre">train_dataset</span></code> and <code class="docutils literal notranslate"><span class="pre">eval_dataset</span></code>.</p></li>
<li><p><strong>train_dataset</strong> – Dataset used for training.
If set to <code class="docutils literal notranslate"><span class="pre">None</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">train()</span></code> will not be available.</p></li>
<li><p><strong>eval_dataset</strong> – Dataset used for evaluation.
If set to <code class="docutils literal notranslate"><span class="pre">None</span></code>, will not perform evaluation.</p></li>
<li><p><strong>rewards</strong> – Dictionary of reward functions.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="phyagi.rl.tuners.isft.isft_tuner.RayISFTTuner.get_train_dataloader">
<span class="sig-name descname"><span class="pre">get_train_dataloader</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">total_consumed_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shuffle</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataLoader</span></span></span><a class="reference internal" href="../_modules/phyagi/rl/tuners/isft/isft_tuner.html#RayISFTTuner.get_train_dataloader"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#phyagi.rl.tuners.isft.isft_tuner.RayISFTTuner.get_train_dataloader" title="Link to this definition">#</a></dt>
<dd><p>Get the training dataloader.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>total_consumed_samples</strong> – Total number of samples consumed so far.</p></li>
<li><p><strong>shuffle</strong> – Whether to shuffle the dataset.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Training dataloader.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="phyagi.rl.tuners.isft.isft_tuner.RayISFTTuner.generate_completions">
<span class="sig-name descname"><span class="pre">generate_completions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prompt_input_ids</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_repetitions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sync_weights</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">generation_kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">vllm.CompletionOutput</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/phyagi/rl/tuners/isft/isft_tuner.html#RayISFTTuner.generate_completions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#phyagi.rl.tuners.isft.isft_tuner.RayISFTTuner.generate_completions" title="Link to this definition">#</a></dt>
<dd><p>Generate completions for the given prompts.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>prompt_input_ids</strong> – Input prompts to generate completions for.</p></li>
<li><p><strong>num_repetitions</strong> – Number of repetitions for each prompt.</p></li>
<li><p><strong>sync_weights</strong> – Whether to synchronize weights with the rollout model.</p></li>
<li><p><strong>batch_size</strong> – Batch size for generation.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List of lists of completion outputs, where each inner list corresponds to a prompt and contains
the generated completions.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="phyagi.rl.tuners.isft.isft_tuner.RayISFTTuner.save_checkpoint">
<span class="sig-name descname"><span class="pre">save_checkpoint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Path</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/phyagi/rl/tuners/isft/isft_tuner.html#RayISFTTuner.save_checkpoint"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#phyagi.rl.tuners.isft.isft_tuner.RayISFTTuner.save_checkpoint" title="Link to this definition">#</a></dt>
<dd><p>Save the current state of the tuner.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>output_dir</strong> – Directory to save the checkpoint.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="phyagi.rl.tuners.isft.isft_tuner.RayISFTTuner.load_checkpoint">
<span class="sig-name descname"><span class="pre">load_checkpoint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">load_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tag</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">load_optimizer_states</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">load_scheduler_states</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/phyagi/rl/tuners/isft/isft_tuner.html#RayISFTTuner.load_checkpoint"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#phyagi.rl.tuners.isft.isft_tuner.RayISFTTuner.load_checkpoint" title="Link to this definition">#</a></dt>
<dd><p>Load a checkpoint from the specified directory.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>load_dir</strong> – Directory to load the checkpoint from.</p></li>
<li><p><strong>tag</strong> – Tag of the checkpoint to load.
If set to <code class="docutils literal notranslate"><span class="pre">None</span></code>, it will load the latest checkpoint available in the directory.</p></li>
<li><p><strong>load_optimizer_states</strong> – Whether to load optimizer states from the checkpoint.</p></li>
<li><p><strong>load_scheduler_states</strong> – Whether to load learning rate scheduler states from the checkpoint.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Trainer state dictionary containing the global step, total consumed samples,
dataloader shuffle state, and seed used for training.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="phyagi.rl.tuners.isft.isft_tuner.RayISFTTuner.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/phyagi/rl/tuners/isft/isft_tuner.html#RayISFTTuner.evaluate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#phyagi.rl.tuners.isft.isft_tuner.RayISFTTuner.evaluate" title="Link to this definition">#</a></dt>
<dd><p>Evaluate the model on the evaluation dataset.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Evaluation metrics containing the rewards and other statistics.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="id1">
<h3>Registry<a class="headerlink" href="#id1" title="Link to this heading">#</a></h3>
<dl class="py function" id="module-phyagi.rl.tuners.registry">
<dt class="sig sig-object py" id="phyagi.rl.tuners.registry.get_tuning_args">
<span class="sig-prename descclassname"><span class="pre">phyagi.rl.tuners.registry.</span></span><span class="sig-name descname"><span class="pre">get_tuning_args</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">framework</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'hf'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'sft'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="reference internal" href="../_modules/phyagi/rl/tuners/registry.html#get_tuning_args"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#phyagi.rl.tuners.registry.get_tuning_args" title="Link to this definition">#</a></dt>
<dd><p>Get tuning arguments for a given framework and task.</p>
<p>Extra keyword arguments that are not shared across the frameworks
are passed as keyword arguments to the framework-specific tuning arguments class.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>output_dir</strong> – Output directory for checkpoints and predictions.</p></li>
<li><p><strong>framework</strong> – Framework to be used.</p></li>
<li><p><strong>task</strong> – Task to be used.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuner arguments.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="phyagi.rl.tuners.registry.get_tuner">
<span class="sig-prename descclassname"><span class="pre">phyagi.rl.tuners.registry.</span></span><span class="sig-name descname"><span class="pre">get_tuner</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">framework</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'hf'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'sft'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tuning_args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_collator</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dataset</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval_dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dataset</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="reference internal" href="../_modules/phyagi/rl/tuners/registry.html#get_tuner"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#phyagi.rl.tuners.registry.get_tuner" title="Link to this definition">#</a></dt>
<dd><p>Get a tuner for a given framework and task.</p>
<p>Extra keyword arguments that are not shared across the frameworks
are passed as keyword arguments to the framework-specific tuner class.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>framework</strong> – Framework to be used.</p></li>
<li><p><strong>task</strong> – Task to be used.</p></li>
<li><p><strong>model</strong> – Model to be tuned or evaluated.</p></li>
<li><p><strong>tuning_args</strong> – Tuner arguments.</p></li>
<li><p><strong>data_collator</strong> – Collate function used for creating a batch from <code class="docutils literal notranslate"><span class="pre">train_dataset</span></code> and <code class="docutils literal notranslate"><span class="pre">eval_dataset</span></code>.</p></li>
<li><p><strong>train_dataset</strong> – Dataset used for tuning.</p></li>
<li><p><strong>eval_dataset</strong> – Dataset used for evaluation.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
</section>
</section>


                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="trainers.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Trainers</p>
      </div>
    </a>
    <a class="right-next"
       href="eval.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Evaluation</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Sections
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#models">Models</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#phyagi.rl.models.actor_config.ActorConfig"><code class="docutils literal notranslate"><span class="pre">ActorConfig</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#phyagi.rl.models.actor_config.ActorConfig.to_dict"><code class="docutils literal notranslate"><span class="pre">ActorConfig.to_dict()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#phyagi.rl.models.actor_config.ActorConfig.__init__"><code class="docutils literal notranslate"><span class="pre">ActorConfig.__init__()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#phyagi.rl.models.actor.Actor"><code class="docutils literal notranslate"><span class="pre">Actor</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#phyagi.rl.models.actor.Actor.__init__"><code class="docutils literal notranslate"><span class="pre">Actor.__init__()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#phyagi.rl.models.actor.Actor.configure_model"><code class="docutils literal notranslate"><span class="pre">Actor.configure_model()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#phyagi.rl.models.actor.Actor.configure_optimizers"><code class="docutils literal notranslate"><span class="pre">Actor.configure_optimizers()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#phyagi.rl.models.actor.Actor.configure_parallelisms"><code class="docutils literal notranslate"><span class="pre">Actor.configure_parallelisms()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#phyagi.rl.models.actor.Actor.on_gpu"><code class="docutils literal notranslate"><span class="pre">Actor.on_gpu()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#phyagi.rl.models.actor.Actor.compute_logprobs"><code class="docutils literal notranslate"><span class="pre">Actor.compute_logprobs()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#phyagi.rl.models.actor.Actor.save_checkpoint"><code class="docutils literal notranslate"><span class="pre">Actor.save_checkpoint()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#phyagi.rl.models.actor.Actor.load_checkpoint"><code class="docutils literal notranslate"><span class="pre">Actor.load_checkpoint()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#phyagi.rl.models.actor.Actor.from_checkpoint"><code class="docutils literal notranslate"><span class="pre">Actor.from_checkpoint()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#phyagi.rl.models.reference.Reference"><code class="docutils literal notranslate"><span class="pre">Reference</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#phyagi.rl.models.reference.Reference.__init__"><code class="docutils literal notranslate"><span class="pre">Reference.__init__()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#rewards">Rewards</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#phyagi.rl.rewards.reward.Reward"><code class="docutils literal notranslate"><span class="pre">Reward</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#phyagi.rl.rewards.reward.Reward.__init__"><code class="docutils literal notranslate"><span class="pre">Reward.__init__()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#phyagi.rl.rewards.reward.Reward.score"><code class="docutils literal notranslate"><span class="pre">Reward.score()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#phyagi.rl.rewards.reward_manager.RewardManager"><code class="docutils literal notranslate"><span class="pre">RewardManager</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#phyagi.rl.rewards.reward_manager.RewardManager.__init__"><code class="docutils literal notranslate"><span class="pre">RewardManager.__init__()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#phyagi.rl.rewards.reward_manager.RewardManager.score"><code class="docutils literal notranslate"><span class="pre">RewardManager.score()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#phyagi.rl.rewards.gsm8k.GSM8kReward"><code class="docutils literal notranslate"><span class="pre">GSM8kReward</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#phyagi.rl.rewards.gsm8k.GSM8kReward.__init__"><code class="docutils literal notranslate"><span class="pre">GSM8kReward.__init__()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#phyagi.rl.rewards.gsm8k.GSM8kReward.score"><code class="docutils literal notranslate"><span class="pre">GSM8kReward.score()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#phyagi.rl.rewards.phi4rp.Phi4RPReward"><code class="docutils literal notranslate"><span class="pre">Phi4RPReward</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#phyagi.rl.rewards.phi4rp.Phi4RPReward.__init__"><code class="docutils literal notranslate"><span class="pre">Phi4RPReward.__init__()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#phyagi.rl.rewards.phi4rp.Phi4RPReward.score"><code class="docutils literal notranslate"><span class="pre">Phi4RPReward.score()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#phyagi.rl.rewards.python_code_executor.PythonCodeExecutorReward"><code class="docutils literal notranslate"><span class="pre">PythonCodeExecutorReward</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#phyagi.rl.rewards.python_code_executor.PythonCodeExecutorReward.__init__"><code class="docutils literal notranslate"><span class="pre">PythonCodeExecutorReward.__init__()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#phyagi.rl.rewards.python_code_executor.PythonCodeExecutorReward.score"><code class="docutils literal notranslate"><span class="pre">PythonCodeExecutorReward.score()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#module-phyagi.rl.rewards.registry">Registry</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#phyagi.rl.rewards.registry.get_reward"><code class="docutils literal notranslate"><span class="pre">get_reward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#rollout">Rollout</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#phyagi.rl.rollout.vllm_worker_config.VLLMWorkerConfig"><code class="docutils literal notranslate"><span class="pre">VLLMWorkerConfig</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#phyagi.rl.rollout.vllm_worker_config.VLLMWorkerConfig.to_dict"><code class="docutils literal notranslate"><span class="pre">VLLMWorkerConfig.to_dict()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#phyagi.rl.rollout.vllm_worker_config.VLLMWorkerConfig.__init__"><code class="docutils literal notranslate"><span class="pre">VLLMWorkerConfig.__init__()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#tuners">Tuners</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#phyagi.rl.tuners.ray_worker_config.RayWorkerConfig"><code class="docutils literal notranslate"><span class="pre">RayWorkerConfig</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#phyagi.rl.tuners.ray_worker_config.RayWorkerConfig.to_dict"><code class="docutils literal notranslate"><span class="pre">RayWorkerConfig.to_dict()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#phyagi.rl.tuners.ray_worker_config.RayWorkerConfig.__init__"><code class="docutils literal notranslate"><span class="pre">RayWorkerConfig.__init__()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#phyagi.rl.tuners.ray_worker.RayWorker"><code class="docutils literal notranslate"><span class="pre">RayWorker</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#phyagi.rl.tuners.ray_worker.RayWorker.__init__"><code class="docutils literal notranslate"><span class="pre">RayWorker.__init__()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#phyagi.rl.tuners.ray_worker.RayWorker.configure_models"><code class="docutils literal notranslate"><span class="pre">RayWorker.configure_models()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#phyagi.rl.tuners.ray_worker.RayWorker.save_actor_model"><code class="docutils literal notranslate"><span class="pre">RayWorker.save_actor_model()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#phyagi.rl.tuners.ray_worker.RayWorker.load_actor_model"><code class="docutils literal notranslate"><span class="pre">RayWorker.load_actor_model()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#phyagi.rl.tuners.ray_worker.RayWorker.save_reference_model"><code class="docutils literal notranslate"><span class="pre">RayWorker.save_reference_model()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#phyagi.rl.tuners.ray_worker.RayWorker.load_reference_model"><code class="docutils literal notranslate"><span class="pre">RayWorker.load_reference_model()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#phyagi.rl.tuners.ray_worker.RayWorker.generate_completions"><code class="docutils literal notranslate"><span class="pre">RayWorker.generate_completions()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#phyagi.rl.tuners.ray_worker.RayWorker.compute_loss"><code class="docutils literal notranslate"><span class="pre">RayWorker.compute_loss()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#phyagi.rl.tuners.ray_worker.RayWorker.update_actor_policy"><code class="docutils literal notranslate"><span class="pre">RayWorker.update_actor_policy()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#hugging-face">Hugging Face</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#grpo">GRPO</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#phyagi.rl.tuners.grpo.grpo_config.RayGRPOConfig"><code class="docutils literal notranslate"><span class="pre">RayGRPOConfig</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#phyagi.rl.tuners.grpo.grpo_config.RayGRPOConfig.__init__"><code class="docutils literal notranslate"><span class="pre">RayGRPOConfig.__init__()</span></code></a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#phyagi.rl.tuners.grpo.grpo_worker.RayGRPOWorker"><code class="docutils literal notranslate"><span class="pre">RayGRPOWorker</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#phyagi.rl.tuners.grpo.grpo_worker.RayGRPOWorker.__init__"><code class="docutils literal notranslate"><span class="pre">RayGRPOWorker.__init__()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#phyagi.rl.tuners.grpo.grpo_worker.RayGRPOWorker.compute_loss"><code class="docutils literal notranslate"><span class="pre">RayGRPOWorker.compute_loss()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#phyagi.rl.tuners.grpo.grpo_worker.RayGRPOWorker.update_actor_policy"><code class="docutils literal notranslate"><span class="pre">RayGRPOWorker.update_actor_policy()</span></code></a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#phyagi.rl.tuners.grpo.grpo_tuner.RayGRPOTuner"><code class="docutils literal notranslate"><span class="pre">RayGRPOTuner</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#phyagi.rl.tuners.grpo.grpo_tuner.RayGRPOTuner.__init__"><code class="docutils literal notranslate"><span class="pre">RayGRPOTuner.__init__()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#phyagi.rl.tuners.grpo.grpo_tuner.RayGRPOTuner.get_train_dataloader"><code class="docutils literal notranslate"><span class="pre">RayGRPOTuner.get_train_dataloader()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#phyagi.rl.tuners.grpo.grpo_tuner.RayGRPOTuner.generate_completions"><code class="docutils literal notranslate"><span class="pre">RayGRPOTuner.generate_completions()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#phyagi.rl.tuners.grpo.grpo_tuner.RayGRPOTuner.save_checkpoint"><code class="docutils literal notranslate"><span class="pre">RayGRPOTuner.save_checkpoint()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#phyagi.rl.tuners.grpo.grpo_tuner.RayGRPOTuner.load_checkpoint"><code class="docutils literal notranslate"><span class="pre">RayGRPOTuner.load_checkpoint()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#phyagi.rl.tuners.grpo.grpo_tuner.RayGRPOTuner.evaluate"><code class="docutils literal notranslate"><span class="pre">RayGRPOTuner.evaluate()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#isft">ISFT</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#phyagi.rl.tuners.isft.isft_config.RayISFTConfig"><code class="docutils literal notranslate"><span class="pre">RayISFTConfig</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#phyagi.rl.tuners.isft.isft_config.RayISFTConfig.__init__"><code class="docutils literal notranslate"><span class="pre">RayISFTConfig.__init__()</span></code></a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#phyagi.rl.tuners.isft.isft_worker.RayISFTWorker"><code class="docutils literal notranslate"><span class="pre">RayISFTWorker</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#phyagi.rl.tuners.isft.isft_worker.RayISFTWorker.__init__"><code class="docutils literal notranslate"><span class="pre">RayISFTWorker.__init__()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#phyagi.rl.tuners.isft.isft_worker.RayISFTWorker.configure_models"><code class="docutils literal notranslate"><span class="pre">RayISFTWorker.configure_models()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#phyagi.rl.tuners.isft.isft_worker.RayISFTWorker.compute_loss"><code class="docutils literal notranslate"><span class="pre">RayISFTWorker.compute_loss()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#phyagi.rl.tuners.isft.isft_worker.RayISFTWorker.update_actor_policy"><code class="docutils literal notranslate"><span class="pre">RayISFTWorker.update_actor_policy()</span></code></a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#phyagi.rl.tuners.isft.isft_tuner.RayISFTTuner"><code class="docutils literal notranslate"><span class="pre">RayISFTTuner</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#phyagi.rl.tuners.isft.isft_tuner.RayISFTTuner.__init__"><code class="docutils literal notranslate"><span class="pre">RayISFTTuner.__init__()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#phyagi.rl.tuners.isft.isft_tuner.RayISFTTuner.get_train_dataloader"><code class="docutils literal notranslate"><span class="pre">RayISFTTuner.get_train_dataloader()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#phyagi.rl.tuners.isft.isft_tuner.RayISFTTuner.generate_completions"><code class="docutils literal notranslate"><span class="pre">RayISFTTuner.generate_completions()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#phyagi.rl.tuners.isft.isft_tuner.RayISFTTuner.save_checkpoint"><code class="docutils literal notranslate"><span class="pre">RayISFTTuner.save_checkpoint()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#phyagi.rl.tuners.isft.isft_tuner.RayISFTTuner.load_checkpoint"><code class="docutils literal notranslate"><span class="pre">RayISFTTuner.load_checkpoint()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#phyagi.rl.tuners.isft.isft_tuner.RayISFTTuner.evaluate"><code class="docutils literal notranslate"><span class="pre">RayISFTTuner.evaluate()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Registry</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#phyagi.rl.tuners.registry.get_tuning_args"><code class="docutils literal notranslate"><span class="pre">get_tuning_args()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#phyagi.rl.tuners.registry.get_tuner"><code class="docutils literal notranslate"><span class="pre">get_tuner()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Microsoft
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2025.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    <p class="last-updated">
  Last updated on Sep 16, 2025.
  <br/>
</p>
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>